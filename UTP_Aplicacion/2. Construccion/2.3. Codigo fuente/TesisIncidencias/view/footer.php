

    <footer class="main-footer">
    <div class="pull-right hidden-xs">
      <b>Version</b> 2.3.7
    </div>
    <strong>Copyright &copy; 2014-2016 <a href="http://almsaeedstudio.com">Almsaeed Studio</a>.</strong> All rights
    reserved.
  </footer>

    <aside class="control-sidebar control-sidebar-dark">
        <!-- Create the tabs -->
        <ul class="nav nav-tabs nav-justified control-sidebar-tabs">
          <li><a href="#control-sidebar-home-tab" data-toggle="tab"><i class="fa fa-home"></i></a></li>
          <li><a href="#control-sidebar-settings-tab" data-toggle="tab"><i class="fa fa-gears"></i></a></li>
        </ul>
        <!-- Tab panes -->
        <div class="tab-content">
          <!-- Home tab content -->
          <div class="tab-pane" id="control-sidebar-home-tab">
            <h3 class="control-sidebar-heading">Recent Activity</h3>
            <ul class="control-sidebar-menu">
              <li>
                <a href="javascript:void(0)">
                  <i class="menu-icon fa fa-birthday-cake bg-red"></i>

                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Langdon's Birthday</h4>

                    <p>Will be 23 on April 24th</p>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:void(0)">
                  <i class="menu-icon fa fa-user bg-yellow"></i>

                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Frodo Updated His Profile</h4>

                    <p>New phone +1(800)555-1234</p>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:void(0)">
                  <i class="menu-icon fa fa-envelope-o bg-light-blue"></i>

                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Nora Joined Mailing List</h4>

                    <p>nora@example.com</p>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:void(0)">
                  <i class="menu-icon fa fa-file-code-o bg-green"></i>

                  <div class="menu-info">
                    <h4 class="control-sidebar-subheading">Cron Job 254 Executed</h4>

                    <p>Execution time 5 seconds</p>
                  </div>
                </a>
              </li>
            </ul>
            <!-- /.control-sidebar-menu -->

            <h3 class="control-sidebar-heading">Tasks Progress</h3>
            <ul class="control-sidebar-menu">
              <li>
                <a href="javascript:void(0)">
                  <h4 class="control-sidebar-subheading">
                    Custom Template Design
                    <span class="label label-danger pull-right">70%</span>
                  </h4>

                  <div class="progress progress-xxs">
                    <div class="progress-bar progress-bar-danger" style="width: 70%"></div>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:void(0)">
                  <h4 class="control-sidebar-subheading">
                    Update Resume
                    <span class="label label-success pull-right">95%</span>
                  </h4>

                  <div class="progress progress-xxs">
                    <div class="progress-bar progress-bar-success" style="width: 95%"></div>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:void(0)">
                  <h4 class="control-sidebar-subheading">
                    Laravel Integration
                    <span class="label label-warning pull-right">50%</span>
                  </h4>

                  <div class="progress progress-xxs">
                    <div class="progress-bar progress-bar-warning" style="width: 50%"></div>
                  </div>
                </a>
              </li>
              <li>
                <a href="javascript:void(0)">
                  <h4 class="control-sidebar-subheading">
                    Back End Framework
                    <span class="label label-primary pull-right">68%</span>
                  </h4>

                  <div class="progress progress-xxs">
                    <div class="progress-bar progress-bar-primary" style="width: 68%"></div>
                  </div>
                </a>
              </li>
            </ul>
            <!-- /.control-sidebar-menu -->

        </div>
          <!-- /.tab-pane -->

          <!-- Settings tab content -->
          <div class="tab-pane" id="control-sidebar-settings-tab">
            <form method="post">
              <h3 class="control-sidebar-heading">General Settings</h3>

              <div class="form-group">
                <label class="control-sidebar-subheading">
                  Report panel usage
                  <input type="checkbox" class="pull-right" checked>
                </label>

                <p>
                  Some information about this general settings option
                </p>
              </div>
              <!-- /.form-group -->

              <div class="form-group">
                <label class="control-sidebar-subheading">
                  Allow mail redirect
                  <input type="checkbox" class="pull-right" checked>
                </label>

                <p>
                  Other sets of options are available
                </p>
              </div>
              <!-- /.form-group -->

              <div class="form-group">
                <label class="control-sidebar-subheading">
                  Expose author name in posts
                  <input type="checkbox" class="pull-right" checked>
                </label>

                <p>
                  Allow the user to show his name in blog posts
                </p>
              </div>
              <!-- /.form-group -->

              <h3 class="control-sidebar-heading">Chat Settings</h3>

              <div class="form-group">
                <label class="control-sidebar-subheading">
                  Show me as online
                  <input type="checkbox" class="pull-right" checked>
                </label>
              </div>
              <!-- /.form-group -->

              <div class="form-group">
                <label class="control-sidebar-subheading">
                  Turn off notifications
                  <input type="checkbox" class="pull-right">
                </label>
              </div>
              <!-- /.form-group -->

              <div class="form-group">
                <label class="control-sidebar-subheading">
                  Delete chat history
                  <a href="javascript:void(0)" class="text-red pull-right"><i class="fa fa-trash-o"></i></a>
                </label>
              </div>
              <!-- /.form-group -->
            </form>
          </div>
          <!-- /.tab-pane -->
        </div>
    </aside>

    <div class="control-sidebar-bg"></div>
    </div>





<script src="css/plugins/jQuery/jquery-2.2.3.min.js"></script>

<!-- Bootstrap 3.3.6 -->
<script src="css/plugins/fastclick/fastclick.js"></script>
<script src="css/plugins/datepicker/bootstrap-datepicker.js"></script>

<script src="assets/js/jquery-ui/jquery-ui.min.js"></script>

<script src="css/bootstrap/js/bootstrap.min.js"></script>



<!-- DataTables -->
<script src="css/plugins/datatables/jquery.dataTables.min.js"></script>
<script src="css/plugins/datatables/dataTables.bootstrap.min.js"></script>


<!-- SlimScroll -->
<script src="css/plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- FastClick -->

<!-- AdminLTE App -->
<script src="css/dist/js/app.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="css/dist/js/demo.js"></script>




<script src="assets/js/ini.js"></script>
<script src="assets/js/jquery.anexsoft-validator.js"></script>
<script src="css/plugins/datatables/dataTables.fixedHeader.min.js"></script>





<!-- Latest compiled and minified JavaScript -->
<script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.1/js/bootstrap-select.min.js"></script>

<!-- (Optional) Latest compiled and minified JavaScript translation files -->



<script src="css/fileinput/fileinput.js" type="text/javascript"></script>




<!-- Bootstrap 3.3.6 Para Borrar-->







<!-- page script -->

<script>

    $("body").tooltip({
    selector: '[rel="tooltip"]'
    });


    $(function () {      
      

    $('#datepicker').datepicker({
      autoclose: true
    });
    $('#datepicker2').datepicker({
      autoclose: true
    });
    $('#datepicker3').datepicker({
      autoclose: true
    });

    $('#datepicker4').datepicker({
      autoclose: true
    });
    $('#datepicker5').datepicker({
      autoclose: true
    });



    });   
</script>




<script>


    $(document).ready(function(){

               //  $('[d="tooltip"]').tooltip();
        //   $('[rel="tooltip"]').tooltip();  


         



              var id = $("#btnClass").val();
         //   var id=document.getElementById("btnClass").value; 

      


            
      $('#tbDTb').DataTable({

        "paging": true,
        "lengthChange": true,
        "searching": true,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "scrollX": true,

        fixedHeader: {
        header: true,
        footer: true
      }

      });

       $('#TabbleDocumentoActivaTAble').DataTable({

        "paging": true,
        "lengthChange": true,
        "searching": true,
        "ordering": true,
        "info": true,
        "autoWidth": false,
        "scrollX": true,

        fixedHeader: {
        header: true,
        footer: true
      }

      });








           $("#frm-generol").submit(function(){
                return $(this).validate();
           });


            //Bloqueo
          $('#texcomentariobloqueo').hide();  
          $('#labeltexcomentariobloqueo').hide();
          $('#labelobjetoseleccionado').hide();
          $('#validacionalerta').hide();
          $('#validacionalertaCliente').hide();
           $('#ExisteNoexiste').hide();          
          $('#labelobjetoseleccionado2').hide();
          $('#TxtPrecionVentaAdd').hide();
          $('#TxtREgistroSanitario').hide();
          


          
          $('#LabelLogin').hide();
          $('#LabelLogin2').hide();
          $('#LabelLogin3').hide();

          

          
          
           var Bloqueo=$('#BLBL_BloqueadoMostrar').val();
           var SelectBloqueoDesbloqueo = $("#SelectBloqueoDesbloqueo");
           if(Bloqueo=="Desbloqueado"){
                  SelectBloqueoDesbloqueo.append('<option value="1">Bloqueado</option>');

                                       
           }
          else{
                  SelectBloqueoDesbloqueo.append('<option value="0">Desbloqueado</option>');
          }
          
          SelectBloqueoDesbloqueo.prop('disabled', false);
          
          ///

             var obtenerSelectBloqueoDesbloqueo=$("#BLBL_Bloqueado").val();

             if(obtenerSelectBloqueoDesbloqueo==1){
                 IdBloqueo=0;
                 //1 bloqueado;
                 //2Desbloqueado
             }
             else if(obtenerSelectBloqueoDesbloqueo==0){
                IdBloqueo=1;
             }
             else{
              IdBloqueo=0;
             }
          
          ////

 



          $('#TIPO_IdMotivoBloqueoDesbloqueo').change(function() {
             var NumeroBloqueo=$('select[name=TIPO_IdMotivoBloqueoDesbloqueo]').val();
          
            if((NumeroBloqueo==6)||(NumeroBloqueo==5)){
                 $('#texcomentariobloqueo').show();  
                 $('#labeltexcomentariobloqueo').show(); 
                 $('#BLBL_Bloqueado').val(IdBloqueo);
                 $('#ControlBloqueoyDesbloqueo').val(5);
                 
                 
            }
            else{
                 $('#texcomentariobloqueo').hide();  
                 $('#labeltexcomentariobloqueo').hide();
                 $('#BLBL_Bloqueado').val(IdBloqueo);  
                 $('#ControlBloqueoyDesbloqueo').val(5);  

            }  
          
          });



             // $('#PERS_RUC').attr('data-validacion-tipo','requerido|numero|min:11');


              $('#PERS_Nombre').attr('data-validacion-tipo','requerido');          
              $('#PERS_Apellido').attr('data-validacion-tipo','requerido');            
              $('#PERS_Sexo').attr('data-validacion-tipo','requerido');
              $('#PERS_DocumentoIdentidad').attr('data-validacion-tipo','requerido|numero|min:8');


             $('#PERS_RazonSocial').attr('readonly','readonly'); 
              $('#PERS_RepresentanteLegal').attr('readonly','readonly');
              $('#PERS_RUC').attr('readonly','readonly');


            $('#TIPO_IdPersona').change(function(){
            var Tipopersonavalor=$('#TIPO_IdPersona').val();
            if(Tipopersonavalor==1){

              $('#PERS_RazonSocial').attr('readonly','readonly'); 
              $('#PERS_RepresentanteLegal').attr('readonly','readonly');
              $('#PERS_RUC').attr('readonly','readonly');
         //     $('#PERS_RUC').attr('data-validacion-tipo','requerido|numero|min:11');


             // $('#PERS_RazonSocial').removeAttr('requerido');
             // $('#PERS_RepresentanteLegal').removeAttr('requerido');
             // $('#PERS_RUC').removeAttr('requerido|numero|min:11');


              $('#PERS_RazonSocial').removeAttr('data-validacion-tipo');
               $('#PERS_RepresentanteLegal').removeAttr('data-validacion-tipo');
              $('#PERS_RUC').removeAttr('data-validacion-tipo');



              var example1=$( "#PERS_RazonSocial" ).parent().parent();
              example1.removeClass('has-error');
              $('label[for="PERS_RazonSocial"] :last-child').remove();

         //     $('label[for="PERS_RazonSocial"]').val('1');

              var example2=$( "#PERS_RepresentanteLegal" ).parent().parent();
              example2.removeClass('has-error');
               $('label[for="PERS_RepresentanteLegal"] :last-child').remove();
            //  $('label[for="PERS_RepresentanteLegal"]').val('1');

              var example3=$( "#PERS_RUC" ).parent().parent();
              example3.removeClass('has-error');
               $('label[for="PERS_RUC"] :last-child').remove();



              $('#PERS_Nombre').removeAttr('readonly');          
              $('#PERS_Apellido').removeAttr('readonly');            
              $('#PERS_Sexo').removeAttr('readonly');
              $('#PERS_DocumentoIdentidad').removeAttr('readonly');


              $('#PERS_Nombre').attr('data-validacion-tipo','requerido');          
              $('#PERS_Apellido').attr('data-validacion-tipo','requerido');            
              $('#PERS_Sexo').attr('data-validacion-tipo','requerido');
              $('#PERS_DocumentoIdentidad').attr('data-validacion-tipo','requerido|numero|min:8');

              

            }
            else{
                    

              $('#PERS_RazonSocial').removeAttr('readonly');
              $('#PERS_RepresentanteLegal').removeAttr('readonly');
              $('#PERS_RUC').removeAttr('readonly'); 


              $('#PERS_RazonSocial').attr('data-validacion-tipo','requerido');
              $('#PERS_RepresentanteLegal').attr('data-validacion-tipo','requerido');
              $('#PERS_RUC').attr('data-validacion-tipo','requerido|numero|min:11');


              $('#PERS_Nombre').attr('readonly','readonly'); 
              $('#PERS_Apellido').attr('readonly','readonly'); 
              $('#PERS_Sexo').attr('readonly','readonly'); 
              $('#PERS_DocumentoIdentidad').attr('readonly','readonly');



              $('#PERS_Nombre').removeAttr('data-validacion-tipo'); 
              $('#PERS_Apellido').removeAttr('data-validacion-tipo'); 
              $('#PERS_DocumentoIdentidad').removeAttr('data-validacion-tipo');


              var example5=$( "#PERS_Nombre" ).parent().parent();
              example5.removeClass('has-error');
              $('label[for="PERS_Nombre"] :last-child').remove();
              var example6=$( "#PERS_Apellido" ).parent().parent();
              example6.removeClass('has-error');
              $('label[for="PERS_Apellido"] :last-child').remove();
              var example7=$( "#PERS_DocumentoIdentidad" ).parent().parent();
              example7.removeClass('has-error');
              $('label[for="PERS_DocumentoIdentidad"] :last-child').remove();


            }
      
            });





          $("#add").click(function(){
                var Selected=$('select[name=PIAC_Id]').val();
                var Select=$('#PIAC_Id option:selected').text();


      

        //$('input:radio[name=PERS_Sexo][value=M]').attr('checked', true);


                 
        $('#TablaActivo tr').each(function() {
            var customerId=$(this).closest("tr").find("td:nth-child(1)").text();
             
            if(customerId == Select)
            {
                seleccionTabla=true;
                return false;                
            }
            else{
                seleccionTabla=false;
            }
        });



        if(seleccionTabla){
            $('#errorvalidador').addClass("has-error");
            $('#labelobjetoseleccionado').show();  
        
        }
        else{
            $('#errorvalidador').removeClass("has-error");
            $('#labelobjetoseleccionado').hide();


            $('#TablaActivo tr:last').after('<tr><td><input type="hidden" name="error"><input type="hidden" name="PIAC_IdActivo[]" value="'+Selected+'">'+Select+'</td><td><input type="text" class="form-control input-sm" style="width: 5em;" name="Activogramaje[]" ></td><td></tr>');


        }
       





          
                
           });
          $("#del").click(function(){
                var trs=$("#TablaActivo tr").length;
                if(trs>1)
                {
                    // Eliminamos la ultima columna
                       $("#TablaActivo tr:last").remove();
                }
             
           });




          
            if(id==='success'){
                 
                  $('.mensaje').addClass("alert alert-success");
                  $("#myModal").modal('show');
                  $('#myModal').delay(3000).fadeOut( "slow", function() {
                        $("#myModal").modal('hide');
            
                  });
              }
              else if(id==='fail'){

                  $('.mensaje').addClass("alert alert-danger");
                  $("#myModal").modal('show');
                  $('#myModal').delay(3000).fadeOut( "slow", function() {
                        $("#myModal").modal('hide');
            
                  });

                   }
        //});
    });
</script>

<script>
        $('#confirm-delete').on('show.bs.modal', function(e) {
            $(this).find('.btn-ok').attr('href', $(e.relatedTarget).data('href'));
            
          //  $('.debug-url').html('Delete URL: <strong>' + $(this).find('.btn-ok').attr('href') + '</strong>');
        });
          $('#confirm-aprov').on('show.bs.modal', function(e) {
            $(this).find('.btn-ok').attr('href', $(e.relatedTarget).data('href'));
            
          //  $('.debug-url').html('Delete URL: <strong>' + $(this).find('.btn-ok').attr('href') + '</strong>');
        });
</script>



<script>
   $('#PIAC_Id').selectpicker({

    size: 6
      });


  $('#LocationForm1').selectpicker({
        size: 4
  });
</script>

<script>
 
 $("#USUA_Foto").fileinput({
 //  maxFileSize: 1000,
  'showUpload': false,
  'allowedFileExtensions': ['jpg', 'png', 'gif']
  });                           
</script>

<script>
 
 $("#PROD_Protocolo").fileinput({
   maxFileSize: 2500,
  'showUpload': false,
  'allowedFileExtensions': ['pdf']
  });                           
</script>




<script>




    var tablaTotales=0;
    var subtotal=0;
    var Numero=1;

    function Agregar() 
    { 
        
        var comboprodutos=$('#PIAC_Id').val();
        var Objetoseleccionado=$('#PIAC_Id option:selected').text();
        if(!VAlidarTablaProducto(Objetoseleccionado)){
       // alert(Objetoseleccionado);
        //alert(comboproductos);
        $.ajax({
         type: 'post',
         url:'?c=logi_orden_compra&a=ProductosListadoDetalle',
          data:'comboprodutos='+comboprodutos
     
        }).done(function(resp){
        //alert(resp);
              var valores = eval(resp);
              var producto=$('#PIAC_Id').val();
              var cantidad=$('#cantidad').val();
              var punitario=$('#punitario').val();
              var dsctoItems=$('#dsctoItems').val();
              var dsctoAdicional=$('#dsctoAdicional').val();
            
              subtotal=((cantidad*punitario)-((cantidad*punitario)*dsctoItems)/100)-(((cantidad*punitario)-((cantidad*punitario)*dsctoItems)/100)*dsctoAdicional)/100;
              tablaTotales+=subtotal;

              subtotal=roundToTwo(subtotal);
              tablaTotales=roundToTwo(tablaTotales);
              //tablaTotales=tablaTotales.toFixed(2);

              $('#subtotal').val(tablaTotales);
              var impuesto=18;
              var importeTotal=parseFloat(tablaTotales)+parseFloat(((tablaTotales*impuesto)/100));
              var igv=(tablaTotales*impuesto)/100;
              $('#igv').val(igv);
              $('#importeTotal').val(importeTotal);
              var DSctoFinacieroTotal=$('#DSctoFinacieroTotal').val();
                DsctoFinanciero=(importeTotal*DSctoFinacieroTotal)/100;
              $('#DsctoFinanciero').val(DsctoFinanciero);
              var TotalNeto=importeTotal-DsctoFinanciero;
              $('#TotalNeto').val(TotalNeto);
              var codigoLetra=""+valores[0][2]+"";
          $('#TablaProductosActiva tr:last').after("<tr><td>"+Numero+"</td><td><input type='hidden' name='idproductotablaget[]' value='"+valores[0][1]+"'>"+valores[0][2]+"</td><td>"+valores[0][15]+"</td><td><input type='hidden' name='iddescripciontablaget[]' value='"+valores[0][3]+"' >"+valores[0][3]+"</td><td><input type='hidden' name='idcantidadtablaget[]' value='"+cantidad+"' >"+cantidad+"</td><td><input type='hidden' name='idpunitariotablaget[]' value='"+punitario+"' >"+punitario+"</td><td><input type='hidden' name='idDsctoitemstablaget[]' value='"+dsctoItems+"' >"+dsctoItems+"</td><td><input type='hidden' name='iddsctoAdicionaltablaget[]' value='"+dsctoAdicional+"' >"+dsctoAdicional+"</td><td><input type='hidden' name='idsubtotaltablaget[]' value='"+subtotal+"' >"+subtotal+"</td><td><input type='hidden' name='idbonificaciontablaget[]' ></td><td><button class='btn btn-danger' onclick='Borrar("+'"'+codigoLetra+'"'+");'><i class='fa fa-fw fa-trash'></i></button></td></tr>");
              Numero++;


              numerototales=ContarCeldas();
              precargar(numerototales);   
          });
        }
    }



    function Bonificacion() 
    { 
        var comboprodutos=$('#PIAC_Id').val();
        var Objetoseleccionado=$('#PIAC_Id option:selected').text();
        if(!VAlidarTablaProducto(Objetoseleccionado)){
          $.ajax({
           type: 'post',
           url:'?c=logi_orden_compra&a=ProductosListadoDetalle',
            data:'comboprodutos='+comboprodutos
       
          }).done(function(resp){

              var valores = eval(resp);
              var bonificaciontd=1;
              var producto=$('#PIAC_Id').val();
              var cantidad=$('#cantidad').val();
              //var punitario=$('#punitario').val();
              //var dsctoItems=$('#dsctoItems').val();
              //var dsctoAdicional=$('#dsctoAdicional').val();
              var punitario=0;
              var dsctoItems=0;
              var dsctoAdicional=0;
              //subtotal=((cantidad*punitario)-((cantidad*punitario)*dsctoItems)/100)-(((cantidad*punitario)-((cantidad*punitario)*dsctoItems)/100)*dsctoAdicional)/100;
              subtotal=0;
              tablaTotales+=subtotal;

              $('#subtotal').val(tablaTotales);
              var impuesto=18;
              var importeTotal=parseFloat(tablaTotales)+parseFloat(((tablaTotales*impuesto)/100));
              var igv=(tablaTotales*impuesto)/100;
              $('#igv').val(igv);
              $('#importeTotal').val(importeTotal);
              var DSctoFinacieroTotal=$('#DSctoFinacieroTotal').val();
                DsctoFinanciero=(importeTotal*DSctoFinacieroTotal)/100;
              $('#DsctoFinanciero').val(DsctoFinanciero);
              var TotalNeto=importeTotal-DsctoFinanciero;
              $('#TotalNeto').val(TotalNeto);
              var codigoLetra=""+valores[0][2]+"";

          $('#TablaProductosActiva tr:last').after("<tr><td>"+Numero+"</td><td><input type='hidden' name='idproductotablaget[]' value='"+valores[0][1]+"'>"+valores[0][2]+"</td><td>"+valores[0][15]+"</td><td><input type='hidden' name='iddescripciontablaget[]' value='"+valores[0][3]+"' >"+valores[0][3]+"</td><td><input type='hidden' name='idcantidadtablaget[]' value='"+cantidad+"' >"+cantidad+"</td><td><input type='hidden' name='idpunitariotablaget[]' value='"+punitario+"' >"+punitario+"</td><td><input type='hidden' name='idDsctoitemstablaget[]' value='"+dsctoItems+"' >"+dsctoItems+"</td><td><input type='hidden' name='iddsctoAdicionaltablaget[]' value='"+dsctoAdicional+"' >"+dsctoAdicional+"</td><td><input type='hidden' name='idsubtotaltablaget[]' value='"+subtotal+"' >"+subtotal+"</td><td><input type='hidden' name='idbonificaciontablaget[]' value='"+bonificaciontd+"'><i class='fa fa-fw fa-check'></i></td><td><button class='btn btn-danger' onclick='Borrar("+'"'+codigoLetra+'"'+");'><i class='fa fa-fw fa-trash'></i></button></td></tr>");
              Numero++;


              numerototales=ContarCeldas();
              precargar(numerototales);    

        });
      }
    }

    function ContarCeldas()
    {

        var numerototales=0;
        var conteo=0;
        $('#TablaProductosActiva tr').each(function() {
        var customerId=$(this).closest("tr").find("td:nth-child(1)").text(conteo);
        var subtotalproducto=$(this).closest("tr").find("td:nth-child(9)").text();
        var num = parseFloat(subtotalproducto);
        //alert(num);
        if(!isNaN(num))
        {
        numerototales+=num;
        }
        conteo++;
        });
        return numerototales;
    }


    function Borrar(NumerodeDatos)
    {

      var numerototales=0;
      var conteo=0;

        $('#TablaProductosActiva tr').each(function() {
            var customerId=$(this).closest("tr").find("td:nth-child(2)").text();
            if(customerId == NumerodeDatos)
            {
             $(this).closest("tr").remove();
            }
        conteo++;
        });

       numerototales=ContarCeldas();
       precargar(numerototales);  
    }

    function recalcular()
    {

              var numerototales= $('#subtotal').val();

              precargar(numerototales);  
    }


    function borrarUltimo()
    {
         var trs=$("#TablaProductosActiva tr").length;
                if(trs>1)
                {
                       $("#TablaProductosActiva tr:last").remove();
                }
                numerototales=ContarCeldas();
                precargar(numerototales);  

    }

    function precargar(numerototalesTotal)
    {
        var numerototales=numerototalesTotal;
        numerototales=roundToTwo(numerototalesTotal);

        $('#subtotal').val(numerototales);
        var impuesto=18;
        var importeTotal=parseFloat(numerototales)+parseFloat(((numerototales*impuesto)/100));

        importeTotal=roundToTwo(importeTotal);
        var igv=(numerototales*impuesto)/100;

        igv=roundToTwo(igv);

        $('#igv').val(igv);
        $('#importeTotal').val(importeTotal);
        var DSctoFinacieroTotal=$('#DSctoFinacieroTotal').val();
          DsctoFinanciero=(importeTotal*DSctoFinacieroTotal)/100;


          DsctoFinanciero=roundToTwo(DsctoFinanciero);

        $('#DsctoFinanciero').val(DsctoFinanciero);

        
        var TotalNeto=importeTotal-DsctoFinanciero;

        TotalNeto=roundToTwo(TotalNeto);
        $('#TotalNeto').val(TotalNeto);
    }



    function roundToTwo(num) {    
    return +(Math.round(num + "e+2")  + "e-2");
    }

     function DescuentoFinacieroProveedor()
    {
        var importeTotal=$('#importeTotal').val();
        $('#importeTotal').val(importeTotal);
        var DSctoFinacieroTotal=$('#DOPR_Descuento').val();
          DsctoFinanciero=(importeTotal*DSctoFinacieroTotal)/100;
        $('#DsctoFinanciero').val(DsctoFinanciero);


        var TotalNeto=importeTotal-DsctoFinanciero;
        $('#TotalNeto').val(TotalNeto);
    }




    function VAlidarTablaProducto(Objetoseleccionado){

        var seleccionTabla;
        $('#TablaProductosActiva tr').each(function() {
            var customerId=$(this).closest("tr").find("td:nth-child(4)").text();
            if(customerId == Objetoseleccionado)
            {
                seleccionTabla=true;
                return false;                
            }
            else{
                seleccionTabla=false;
            }
        });

        if(seleccionTabla){
            $('#errorvalidador').addClass("has-error");
            $('#labelobjetoseleccionado').show();  
        
        }
        else{
            $('#errorvalidador').removeClass("has-error");
            $('#labelobjetoseleccionado').hide();

        }
        return seleccionTabla;

    }







    function GuardarFormMultiple() 
    {         
        var trs=$("#TablaProductosActiva tr").length;
        var erro1=  $('#ORCO_Serie').val();
        var erro2=  $('#ORCO_Numero').val();
        var erro3=  $('#ORCO_PlazoPago').val();
        var erro4=  $('#datepicker').val();
        var erro5=  $('#datepicker2').val();
      
            if(!VAlidarControles(erro1,erro2,erro3,erro4,erro5,trs))
            {

                var dataString = $("#frmsumbit1, #frmsumbit3, #frmsumbit4").serialize();
                $.ajax( {
                    type: 'POST',
                    url: '?c=logi_orden_compra&a=Guardar',
                    data: dataString,
                  }).done(function(resp){
                     //alert(resp);
                      location.href="index.php?c=logi_orden_compra";
                    
                });
           }
           else{  
                  
                // $('#errorvalidadorinputs').focus();
              //  document.getElementById('validacionalerta').focus();
                  $('#messageindex').focus();
           }

            // $('#errorvalidadorinputs').focus();
              //  document.getElementById('validacionalerta').focus();
               //   $('#validacionalerta').first().focus();
    }

    function GuardarFormMultipleDocumento() 
    {         
                var trs=$("#TabbleDocumentoActiva tr").length;
                var erro1=  $('#PERS_IdProveedor').val();
                var erro2=  $('#datepicker3').val();
                var erro3=  $('#ORCO_PlazoPago').val();
                var erro4=  $('#DOPR_SerieDocReferencia').val();
                var erro5=  $('#DOPR_NumeroDocReferencia').val();

            //    var erro6=  $('#idvencProductotablaget').val();
                


            if(!VAlidarControlesProveedor(erro1,erro2,erro3,trs,erro4,erro5))
            {

                var dataString = $("#frmsumbit1, #frmsumbit3, #frmsumbit4").serialize();
                $.ajax( {
                    type: 'POST',
                    url: '?c=logi_documento_proveedor&a=Guardar',
                    data: dataString,
                  }).done(function(resp){
                     alert(resp);
                   // location.href="index.php?c=logi_documento_proveedor";
                   // 
                });
            } 
            else{  
                  
                // $('#errorvalidadorinputs').focus();
              //  document.getElementById('validacionalerta').focus();
               //   $('#messageindex').focus();
                     $('#messageindex').focus();
           }
    }


    function VAlidarControlesProveedor(erro1,erro2,erro3,erro4,erro5,erro6){
        var alertamensaje;
        var msj1,msj2,msj3,msj4,msj5,msj6;
     
        msj1=truefalse(erro1);
        msj2=truefalseFecha(erro2);
        msj3=truefalse(erro3);
        msj4=truefalseTabla(erro4);
        msj5=truefalse(erro5);
        msj6=truefalse(erro6);
        var msj7=$('#Hoy').val();

        var msj8,msj9,msj10,msj11;

      
        $('input[name^="idvencProductotablaget"]').each(function() {
               //alert($(this).val());
              var temp=$(this).val();
        
               if( (new Date(msj7).getTime() >= new Date(temp).getTime()))
               {
                   msj8=true;
                   return false;
                //  return msj8; 
               }else{
                  msj8=false;


               }
          

        });



          $('input[name^="idPVenta"]').each(function() {
               //alert($(this).val());
              var temp=$(this).val();
        
               if((temp==0)||(temp==""))
               {
                   msj10=true;
                   return false;
                //  return msj8; 
               }else{
                  msj10=false;


               }
          

        });


          $('input[name^="idRSanitario"]').each(function() {
               //alert($(this).val());
              var temp=$(this).val();
        
               if((temp==0)||(temp==""))
               {
                   msj11=true;
                   return false;
                //  return msj8; 
               }else{
                  msj11=false;


               }
          

        });









           
           
            if((msj1==true)||(msj2==true)||(msj3==true)||(msj4==true)||(msj5==true)||(msj6==true)||(msj8==true)||(msj10==true)||(msj11==true))
            {
                     alertamensaje=true;
                     $('#validacionalerta').show();
                     $('#validacionalerta').addClass("has-error");                     
            
                     if(msj1==true){ $('#TxtProovedorAlert').show();
                                     $('#eroovalidador1').addClass("has-error");
                    }
                    else{ $('#TxtProovedorAlert').hide();
                          $('#eroovalidador1').removeClass("has-error");
                    }
                     if(msj2==true){ $('#TxtFechaIngAlert').show();
                                     $('#eroovalidador3').addClass("has-error");
                    }
                    else{ $('#TxtFechaIngAlert').hide();
                          $('#eroovalidador3').removeClass("has-error");
                    }
                     if(msj3==true){ $('#TxtPlazoAlert').show();
                                     $('#eroovalidador2').addClass("has-error");
                      }
                     else{ $('#TxtPlazoAlert').hide();
                           $('#eroovalidador2').removeClass("has-error");
                    }
                     if(msj4==true){ $('#TxtTablaAlert').show();
                                     $('#eroovalidador4').addClass("has-error");
                    }
                    else{ $('#TxtTablaAlert').hide();
                           $('#eroovalidador4').removeClass("has-error");
                    }
                    if(msj5==true){ $('#TxtReferenciaAlert').show();
                                     $('#eroovalidador6').addClass("has-error");
                    }
                    else{ $('#TxtReferenciaAlert').hide();
                          $('#eroovalidador6').removeClass("has-error");
                    }
                      if(msj6==true){ $('#TxtReferenciaAlert').show();
                                     $('#eroovalidador6').addClass("has-error");
                    }
                    else{ $('#TxtReferenciaAlert').hide();
                          $('#eroovalidador6').removeClass("has-error");
                    }
                    if(msj8==true){ $('#TxtFechaVenAlert').show();
                                    
                    }
                    else{ $('#TxtFechaVenAlert').hide();
                        
                    }

                    if(msj10==true){ 
                      $('#TxtPrecionVentaAdd').show();
                                    
                    }
                    else{
                     $('#TxtPrecionVentaAdd').hide();
                        
                    }

                    if(msj11==true){ 
                      $('#TxtREgistroSanitario').show();
                                    
                    }
                    else{
                     $('#TxtREgistroSanitario').hide();
                        
                    }


                
             
            
            

            }else
            {
               // alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
                $('#validacionalerta').removeClass("has-error");
            //    $('#errorvalidadorinputs').removeClass("has-error");
                $('#validacionalerta').hide();
                alertamensaje=false;
            }
            
            return alertamensaje;
    }


    function VAlidarControles(erro1,erro2,erro3,erro4,erro5,erro6){
        var alertamensaje;
        var msj1,msj2,msj3,msj4,msj5;
       // var erro1=  $('#ORCO_Serie').val();
        //var erro2=  $('#ORCO_Numero').val();
       // var erro3=  $('#ORCO_PlazoPago').val();
       // var erro4=  $('#ORCO_FechaEmision').val();
      //  var erro5=  $('#ORCO_FechaVencimiento').val();
     
        msj1=truefalse(erro1);
        msj2=truefalse(erro2);
        msj3=truefalse(erro3);
        msj4=compararFechas(erro4,erro5);
        msj5=truefalseTabla(erro6);
        //alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
           
            if((msj1==true)||(msj2==true)||(msj3==true)||(msj4==true)||(msj5==true))
            {
                     alertamensaje=true;
                     $('#validacionalerta').show();
                     $('#validacionalerta').addClass("has-error");
                   //  $('#validacionalerta').focus(function() {
                     // alert("focus");
                     // });
                    // $('#eroovalidador3').addClass("has-error");
                     
            
                     if(msj1==true){ $('#TxtNumeroAlert').show();
                                     $('#eroovalidador3').addClass("has-error");
                    }
                    else{ $('#TxtNumeroAlert').hide();
                          $('#eroovalidador3').removeClass("has-error");
                    }
                     if(msj2==true){ $('#TxtSerieAlert').show();
                                     $('#eroovalidador3').addClass("has-error");
                    }
                    else{ $('#TxtSerieAlert').hide();
                          $('#eroovalidador3').removeClass("has-error");
                    }
                     if(msj3==true){ $('#TxtPlazoAlert').show();
                                     $('#eroovalidador5').addClass("has-error");
                      }
                     else{ $('#TxtPlazoAlert').hide();
                           $('#eroovalidador5').removeClass("has-error");
                    }
                     if(msj4==true){ $('#TxtFechaAlert').show();
                                     $('#eroovalidador4').addClass("has-error");
                    }
                    else{ $('#TxtFechaAlert').hide();
                           $('#eroovalidador4').removeClass("has-error");
                    }
                     if(msj5==true){ $('#TxtTablaAlert').show();
                                     $('#eroovalidador7').addClass("has-error");
                    }
                    else{ $('#TxtTablaAlert').hide();
                           $('#eroovalidador7').removeClass("has-error");
                    }

                
             
            
            

            }else
            {
               // alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
                $('#validacionalerta').removeClass("has-error");
            //    $('#errorvalidadorinputs').removeClass("has-error");
                $('#validacionalerta').hide();
                alertamensaje=false;
            }
            
            return alertamensaje;
    }


    function truefalse(SErerERRotipoValidador){
        var truefalsevar;
        if(SErerERRotipoValidador==0||SErerERRotipoValidador==""){
            truefalsevar=true;
         }
         else{
            truefalsevar=false;
         }
         return truefalsevar;

    }
    function truefalseTabla(SErerERRotipoValidador){
        var truefalsevar;
        if(SErerERRotipoValidador<2){
            truefalsevar=true;
         }
         else{
            truefalsevar=false;
         }
       //  alert('cantidad'+SErerERRotipoValidador+'campos '+truefalsevar);
         return truefalsevar;

    }

    function truefalseFecha(SErerERRotipoValidador){
        var truefalsevar;
        if(SErerERRotipoValidador==0000-00-00||SErerERRotipoValidador==""){
            truefalsevar=true;
         }
         else{
            truefalsevar=false;
         }
         return truefalsevar;

    }
    

    function compararFechas(startDt,endDt){
      var truefalsevar;
        if( (new Date(startDt).getTime() <= new Date(endDt).getTime()))
          {
              truefalsevar=false;
          }
          else{

              truefalsevar=true;
          }
          return truefalsevar;
    }


    function GuardarFomulario() 
    {         
        var erro1=  $('#Importe').val();
        var erro2=  $('#MOCA_Descripcion').val();

           if(!VAlidarControlesCAja(erro1,erro2)){
                var dataString = $("#frmsumbit1").serialize();
                $.ajax( {
                    type: 'POST',
                    url: '?c=fina_movimientocaja&a=Guardar',
                    data: dataString,
                  }).done(function(resp){

                      ObtenerListadoTAblaC();
                
                    

                });    

            } 
    }

    function ObtenerListadoTAblaC(){


       
                $.ajax( {
                    type: 'POST',
                    url: '?c=fina_movimientocaja&a=ListarTipos',
                 //   data: dataString,
                  }).done(function(resp){

                    var valores = eval(resp);

                    $('#TabbleDocumentoActivaTAble tbody').remove();
                    $("#TabbleDocumentoActivaTAble").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                    $("#TabbleDocumentoActivaTAble tbody").append('<tr><td>'+valores[i][1]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][22]+'</td><td>'+valores[i][7]+'</td><td>'+valores[i][5]+'</td><td>'+valores[i][6]+'</td><td>'+valores[i][21]+'</td></tr>');
                    }
                    // alert(resp);</tr>
                    //  location.href="index.php?c=logi_documento_proveedor";
                    
                });    


    }


     function VAlidarControlesCAja(erro1,erro2){
        var alertamensaje;
        var msj1,msj2;

        msj1=truefalse(erro1);
        msj2=truefalse(erro2);

           
            if((msj1==true)||(msj2==true))
            {
                     alertamensaje=true;            
                     if(msj1==true){ 
                             $('#errorvalidador').addClass("has-error");
                             $('#labelobjetoseleccionado').show();  
                    }
                     else{ $('#labelobjetoseleccionado').hide();
                          $('#errorvalidador').removeClass("has-error");
                    }

                    if(msj2==true){ 
                             $('#errorvalidador2').addClass("has-error");
                             $('#labelobjetoseleccionado2').show();  
                    }
                     else{ $('#labelobjetoseleccionado2').hide();
                          $('#errorvalidador2').removeClass("has-error");
                    }

            }
            else{
                    alertamensaje=false;
            }
            
            return alertamensaje;
    }



</script>
<script>
  $('#PorLoteChange').change(function(){
    if($('#PorLoteChange').is(':checked')){ 
             // $('#SaldoAlmacenTablaid  td:nth-child(3),th:nth-child(3)').show();
               $('#SaldoAlmacenTablaid tbody').remove();
        } else {
               //   $('#SaldoAlmacenTablaid  td:nth-child(3),th:nth-child(3)').hide();
                     $('#SaldoAlmacenTablaid tbody').remove();
        }
    });

</script>

<script>

function SaldoAlmacenTabla(){

var Empresa =  $('#EMPR_Id').val();
var Almaid = $('#ALMA_Id').val();
var Fecha = $('#datepicker').val();
var Checkbox;
     if($('#PorLoteChange').is(':checked')){ 
            Checkbox=1;
        } else {
            Checkbox=0;
        }

//alert('Empresa      '+ Empresa+'Almaid     '+Almaid+'Fecha      '+Fecha+'Checkbox     '+Checkbox);

  


        $.ajax({
         type: 'post',
         url:'?c=saldo_almacen&a=SaldoTabla',
         //data:'idtabla'+idtabla
         data:'Empresa='+Empresa+'&Almaid='+Almaid+'&Fecha='+Fecha+'&Checkbox='+Checkbox
         //data:'id='+num
     
        }).done(function(resp){

            //alert(resp);

              var valores = eval(resp);
              

               $('#SaldoAlmacenTablaid tbody').remove();
                    $("#SaldoAlmacenTablaid").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
              
                    $("#SaldoAlmacenTablaid tbody").append('<tr><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][6]+'</td><td>'+valores[i][7]+'</td></tr>');
                    }

            // valores[0][0]
          

        
        });   

 //  SaldoAlmacenTablaid

} 

  
function PaswordValidador() 
  {     

     var password1= $('#Password').val();
     var password2= $('#NewPassword').val();
     var password3= $('#NewPassword2').val();

     if((password1!="")||(password2!="")||(password3!=""))
     {
        var dataString = $("#FormuserPerfil").serialize();
        $.ajax({
         type: 'post',
         url:'?c=user_perfil&a=VerfificarUsuarioAjaxPerifl',
         data:dataString,


        }).done(function(resp){
          // alert(resp);
              var valores = eval(resp);

        if(valores.length>0){

                $('#LabelLogin').hide();
                $('#PasErroLogin').removeClass("has-error");
                    if(EqualPasswordDismin()){
                      //  alert('logre entrar');
                          $.ajax({
                             type: 'post',
                             url:'?c=user_perfil&a=TxPerfilActualizar',
                             data:dataString,
                     
                            }).done(function(resp){
                            location.href="index.php?c=login";                                   
                           });
                      }                
          }

      else {              
              $('#PasErroLogin').addClass("has-error");
              $('#LabelLogin').show(); 

          }

          });


       } 
    else {
                  $('#PasErroLogin').addClass("has-error");
                  $('#LabelLogin').show();  
                  $('#PasErroLogin2').addClass("has-error");
                  $('#LabelLogin2').show();  
                  $('#PasErroLogin3').addClass("has-error");
                  $('#LabelLogin3').show();  
          }
  }

  function EqualPasswordDismin() {

     var password4= $('#NewPassword').val();
     var password5= $('#NewPassword2').val();

   //  alert('a'+password4+'a                a'+password5+'a');
     var mensajerror;


     if(password4 == password5){
      mensajerror=true;
          $('#PasErroLogin2').removeClass("has-error");
          $('#LabelLogin2').hide();  
          $('#PasErroLogin3').removeClass("has-error");
          $('#LabelLogin3').hide();  

       
     }
     else{  
         mensajerror=false;
              $('#PasErroLogin2').addClass("has-error");
              $('#LabelLogin2').show();  
              $('#PasErroLogin3').addClass("has-error");
              $('#LabelLogin3').show();  
 

     }

     return mensajerror;
   //  alert(mensajerror);

  }

  function ActualizarTablaProductosAprobRchr(){
  var Pendientes;
  var Aprobados;
  var  Rechazados;

   var datepicker=$('#datepicker').val();
   var datepicker2=$('#datepicker2').val();

   Pendientes= chekedNocheked($('#Pendientes'));
   Aprobados= chekedNocheked($('#Aprobados'));
   Rechazados=chekedNocheked($('#Rechazados'));

    $.ajax({
         type: 'post',
         url:'?c=aprovarrechazar_ordencompra&a=TablaListadoDetalle',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         data:'Pendientes='+Pendientes+'&Aprobados='+Aprobados+'&Rechazados='+Rechazados+'&datepicker='+datepicker+'&datepicker2='+datepicker2
     
        }).done(function(resp){
       // alert(resp);
              var valores = eval(resp);

               $('#TableDocumentosAprevarRechazar tbody').remove();
                    $("#TableDocumentosAprevarRechazar").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                    $("#TableDocumentosAprevarRechazar tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+' - '+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td>'+valores[i][6]+'</td><td>'+valores[i][7]+'</td><td> <button class="btn btn-social-icon btn-info btn-sm"  data-toggle="modal" data-target="#ModalFormulario"  rel="tooltip" title="Ver Detalle" onclick="DetalleModal('+valores[i][0]+')"  ><i class="fa fa-fw fa-eye"></i></button>  <a class="btn btn-social-icon btn-success btn-sm" data-href="?c=aprovarrechazar_ordencompra&a=Aprobar&Id='+valores[i][0]+'&Estado=6"  data-target="#confirm-aprov" data-toggle="modal" rel="tooltip" title="Aprobar O.C"><i class="fa fa-fw fa-check-square-o"></i></a>  <a class="btn btn-social-icon btn-danger btn-sm" data-href="?c=aprovarrechazar_ordencompra&a=Rechazar&Id='+valores[i][0]+'&Estado=7" data-target="#confirm-delete" data-toggle="modal" rel="tooltip" title="Rechazar O.C"><i class="fa fa-fw fa-close"></i></a></td></tr>');
                    }
    

  
          });





//    alert(datepicker+" * "+datepicker2+" * "+Pendientes+" * "Aprobados+" * "+Rechazados);

//alert(datepicker+" * "+datepicker2+" * "+Pendientes+" * "+Aprobados+" * "+Rechazados);

  }


  function chekedNocheked(comparacion){
    var resultadocheked;

        if(comparacion.is(':checked')){ 
            resultadocheked=true;
            
        } else {
            resultadocheked=false;
        }
        return resultadocheked;

  }

    function DetalleModal(id){
     var num=id;
       $.ajax({
         type: 'post',
         url:'?c=aprovarrechazar_ordencompra&a=TablaListadoDetalleDetalle',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         data:'id='+num
     
        }).done(function(resp){
       // alert(resp);
              var valores = eval(resp);
              var elemento;

               $('#TableDocumentosAprevarRechazarDetalle tbody').remove();
                    $("#TableDocumentosAprevarRechazarDetalle").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                      if(valores[i][5]==1){
                        elemento=" <i class='fa fa-fw fa-check'></i>";
                      }
                      else{
                        elemento=" ";
                      }
                    $("#TableDocumentosAprevarRechazarDetalle tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+elemento+'</td></tr>');
                    }

  

  
          });


  }



  function DetalleModalProductos(){
   //  var num=id;
       $.ajax({
         type: 'post',
         url:'?c=kardex&a=ListadoProductosTabla',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         //data:'id='+num
     
        }).done(function(resp){
       // alert(resp);
              var valores = eval(resp);
             // var elemento;

               $('#TableProductosKardex tbody').remove();
                    $("#TableProductosKardex").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
              
                    $("#TableProductosKardex tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td> <a href="?c=kardex&a=Crud&Id='+valores[i][0]+'" class="btn btn-social-icon btn-info btn-sm"   rel="tooltip" title="Seleccionar" ><i class="fa fa-fw fa-check-circle-o"></i></a> </td></tr>');
                    }

  

  
          });


  }


    function ModalDocumentodeVenta(){

   //  var num=id;
       $.ajax({
         type: 'post',
         url:'?c=documento_venta&a=TablaModalPersonasDocuemtoVenta',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         //data:'id='+num
     
        }).done(function(resp){


       // alert(resp);
              var valores = eval(resp);
             // var elemento;
              var usuarioBloqueo;  
               $('#DocumentoVEntaFade tbody').remove();
                    $("#DocumentoVEntaFade").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){

                       if(valores[i][5]=='Bloqueado'){
                               usuarioBloqueo= ' onclick="return false;" disabled ';
                                }
                            else{
                                usuarioBloqueo=' data-dismiss="modal"  onclick="closeModal('+valores[i][0]+')" ';
                            }

              
                    $("#DocumentoVEntaFade tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td> <a href="" class="btn btn-social-icon btn-info btn-sm"   rel="tooltip" title="Seleccionar" '+usuarioBloqueo+'><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }

                   //   table = $('#example').DataTable( {
                     //     paging: false
                     // } );
                       
                     // table.destroy();

                  //  $('#DocumentoVEntaFade').DataTable({});
            $("#DocumentoVEntaFade").dataTable().fnDestroy();
             var datatabledocumentoVenta =  $('#DocumentoVEntaFade').DataTable();
          //    datatabledocumentoVenta.columns.adjust().responsive.recalc();
              //      if ( !$.fn.dataTable.isDataTable( '#DocumentoVEntaFade' ) ) {
                          //   var datatabledocumentoVenta =  $('#DocumentoVEntaFade').DataTable({});
                         // }
                   //       else {
                     //         datatabledocumentoVenta = $('#DocumentoVEntaFade').DataTable( {
                       //           //paging: tr
                         ///     } );
                         // }

  
          });


  }

  function closeModal(idtabla){

         $.ajax({
         type: 'post',
         url:'?c=documento_venta&a=DatosClientes',
         //data:'idtabla'+idtabla
         data:'idtabla='+idtabla
         //data:'id='+num
     
        }).done(function(resp){

           // alert(resp);
              var valores = eval(resp);
            //  alert
           // for(i=0;i<valores.length;i++){
            
             $("#DAtoClientesid").val(valores[0][0]);
             $("#DAtoClientesname").val(valores[0][1]);
             if(valores[0][2]==""){
             $("#TipoDocumentoClienteIn").val(valores[0][3]);
             }
             else{
             $("#TipoDocumentoClienteIn").val(valores[0][2]);
             }
             $("#ClienteDireccionIn").val(valores[0][4]);
             
           // }     
               
  
//4
      
      });
}

  function ModalDocumentodeVentaProductos(){
          $.ajax({
         type: 'post',
         url:'?c=documento_venta&a=TablaModalProductos',     
        }).done(function(resp){
              var ProductosBloqueados;
              var valores = eval(resp);

               $('#DocumentoVEntaProductosModal tbody').remove();
                    $("#DocumentoVEntaProductosModal").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){

         

                            if(valores[i][5]<=0){
                               ProductosBloqueados= ' onclick="return false;" disabled ';
                                }
                            else{
                               ProductosBloqueados=' data-dismiss="modal"  onclick="closeModalProductos('+valores[i][0]+')" ';
                            }


              
                    $("#DocumentoVEntaProductosModal tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td>'+valores[i][6]+'</td><td> <a href="" class="btn btn-social-icon btn-info btn-sm"  rel="tooltip" title="Seleccionar" '+ProductosBloqueados+' ><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }

            $("#DocumentoVEntaProductosModal").dataTable().fnDestroy();
             var DocumentoVEntaProductosModal =  $('#DocumentoVEntaProductosModal').DataTable();

  
          });

    
  }


  function ModalHistorialIncidencias(){

    //var cells = $("#TablaModalHistorialIncidencias tr").find('td');
    //var y = document.getElementById("TablaModalHistorialIncidencias").innerText;
    //var result = cells.eq(2).text(); // This isn't used?
    var INCI_Id = $("#INCI_Id").val();
    //alert (INCI_Id);

          $.ajax({
         type: 'post',
         url:'?c=cierre&a=TablaModalHistorial',
          data:'INCI_Id='+INCI_Id     
        }).done(function(resp){
              var ProductosBloqueados;
              var valores = eval(resp);
              
              //var myArray = eval(result);
              //alert("dentro de modal");

              $('#TablaModalHistorialIncidencias tbody').remove();
                    $("#TablaModalHistorialIncidencias").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){


                     $("#TablaModalHistorialIncidencias tbody").append(
                      '<tr><td>'+
                      valores[i][0]+'</td><td>'+
                      valores[i][1]+'</td><td>'+
                      valores[i][2]+'</td><td>'+
                      valores[i][3]+'</td><td>'+
                      valores[i][4]+'</td><td>'+
                      valores[i][5]+'</td><td>'+
                      valores[i][6]+'</td><td>'+
                      valores[i][7]+'</td><td>'+
                      ' <a href="" class="btn btn-social-icon btn-info btn-sm"  rel="tooltip" title="registrado"><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }


            $("#TablaModalHistorialIncidencias").dataTable().fnDestroy();
             var TablaModalHistorialIncidencias =  $('#TablaModalHistorialIncidencias').DataTable();

            
          });

    
  }


var CodigoIncidencia; 
 
$(document).ready(function () {    

     $('#tbDTb tr').click(function (event) {
           //alert($(this).attr('id'));
           CodigoIncidencia = $(this).attr('id');
          //alert(CodigoIncidencia); //trying to alert id of the clicked row  
          ModalHistorialIncidenciasCierre(CodigoIncidencia);

     });
     
 });



  function ModalHistorialIncidenciasCierre(CodigoInci){

     
  //CodigoIncidencia = $('#tbDTb tr').attr('id')
    var result = CodigoInci; // This isn't used?
    var INCI_Id = result;
    //alert (result);
   // alert (row_index);

          $.ajax({
         type: 'post',
         url:'?c=cierre&a=TablaModalHistorial',
          data:'INCI_Id='+INCI_Id     
        }).done(function(resp){
              var ProductosBloqueados;
              var valores = eval(resp);
               //alert (valores[1][2]);
              //var myArray = eval(result);
              //alert("dentro de modal");

              $('#TablaModalHistorialIncidencias tbody').remove();
                    $("#TablaModalHistorialIncidencias").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){

                      
                     $("#TablaModalHistorialIncidencias tbody").append(
                      '<tr><td>'+
                      valores[i][0]+'</td><td>'+
                      valores[i][1]+'</td><td>'+
                      valores[i][2]+'</td><td>'+
                      valores[i][3]+'</td><td>'+
                      valores[i][4]+'</td><td>'+
                      valores[i][5]+'</td><td>'+
                      valores[i][6]+'</td><td>'+
                      valores[i][7]+'</td><td>'+
                      ' <a href="" class="btn btn-social-icon btn-info btn-sm"  rel="tooltip" title="registrado"><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }


            $("#TablaModalHistorialIncidencias").dataTable().fnDestroy();
             var TablaModalHistorialIncidencias =  $('#TablaModalHistorialIncidencias').DataTable();

            
          });

    
  }


var fl = document.getElementById('ControlSubeArchivos');

fl.onchange = function(e){ 
    var ext = this.value.match(/\.(.+)$/)[1];
    switch(ext)
    {
        case 'jpg':
        case 'bmp':
        case 'png':
        case 'tif':
           // alert('allowed');
            break;
        default:
            alert('Archivo no permitido');
            this.value='';
    }
};


    function closeModalProductos(idtabla)
    {

         $.ajax({
         type: 'post',
         url:'?c=documento_venta&a=DatosProductos',
         //data:'idtabla'+idtabla
         data:'idtabla='+idtabla
         //data:'id='+num
     
        }).done(function(resp){

           // alert(resp);
              var valores = eval(resp);
            //  alert
           // for(i=0;i<valores.length;i++){
            
             $("#InternoProductoVenta").val(valores[0][0]);
             $("#CodProductoVEntaIn").val(valores[0][1]);
             $("#NombreProductoVEntaIn").val(valores[0][2]);
      
             $("#StockProductoVEntaIn").val(0);
        
             $("#CantidadProductoVEntaIn").val(0);
     
             $("#PrecioProductoVEntaIn").val(valores[0][3]);
             
           // }     
               
  
//4
      
      });


    }

    var IdVentaDocVen=1;
    function AgregarCampos()
    { 

        var CantidadProductDocumento = $('#CantidadProductoVEntaIn').val();
        var PrecioProductDocumento = $('#PrecioProductoVEntaIn').val();
        var CodProductoDocumento = $('#CodProductoVEntaIn').val();
        var DescuentoItemVenta = $('#DescuentoImteVEntaProducto').val();
        var DescuentoObtenido;


       if(!ProductosTablaDocumentoVEntaValidaro(CantidadProductDocumento,PrecioProductDocumento,CodProductoDocumento)){

       var IdProducto= $("#InternoProductoVenta").val();
       var cantidad,preciounitario,subtotalVentaProducto,VAlorVEntaTotal;

        $.ajax({
         type: 'post',
         url:'?c=documento_venta&a=TablaValorVentaIn',
         //data:'idtabla'+idtabla
         data:'IdProducto='+IdProducto
         //data:'id='+num
     
        }).done(function(resp){

           // alert(resp);
              var valores = eval(resp);
              cantidad = $("#CantidadProductoVEntaIn").val();
              preciounitario=$("#PrecioProductoVEntaIn").val(); 
              subtotalVentaProducto=cantidad*preciounitario;


               decuentopedido=$("#DescuentoProductoPedido").val();  
              

              if(DescuentoItemVenta==0){
                DescuentoObtenido=0;
              }
              else{
                DescuentoObtenido=((cantidad*preciounitario)*DescuentoItemVenta)/100;
              }


              

                $("#TablaPrincipalDocumentoVenta").append('<tbody></tbody>');
                $("#TablaPrincipalDocumentoVenta > tbody:last-child ").append('<tr><td>'+IdVentaDocVen+'</td><td><input type="hidden" name="tblidTablaPrincipal[]" value="'+valores[0][0]+'">'+valores[0][1]+'</td><td><input type="hidden" name="tbldescripcionTablaPrincipal[]" value="'+valores[0][2]+'">'+valores[0][2]+'</td><td>'+valores[0][3]+'</td><td><input type="hidden" name="tblcantidadTablaPrincipal[]" value="'+cantidad+'">'+cantidad+'</td><td><input type="hidden" name="tblpreciounitarioTablaPrincipal[]" value="'+preciounitario+'">'+preciounitario+'</td><td><input type="hidden" name="tbldescuentoObtenido[]" value="'+DescuentoObtenido+'">'+DescuentoObtenido+'</td><td><input type="hidden" name="tblsubtotalTablaPrincipal[]" value="'+subtotalVentaProducto+'">'+subtotalVentaProducto+'</td><td><input type="hidden" name="tblBonificacionTablaPrincipal[]" value="0"> </td></td><td><button class="btn btn-danger btn-sm  "  rel="tooltip" title="Quitar"  onclick=QuitarElementoSeleccionado("'+valores[0][1]+'")><i class="fa fa-fw fa-trash-o"></i></button></td></td></tr>');
       
        recalcularDocumentoVenta();

        IdVentaDocVen++;
        
        });  
        }  

         

    }



    function AgregarCamposBonificacionVenta()
    { 

        var CantidadProductDocumento = $('#CantidadProductoVEntaIn').val();
        var PrecioProductDocumento = $('#PrecioProductoVEntaIn').val();
        var CodProductoDocumento = $('#CodProductoVEntaIn').val();
        var DescuentoItemVenta = $('#DescuentoImteVEntaProducto').val();
        var DescuentoObtenido;


       if(!ProductosTablaDocumentoVEntaValidaro(CantidadProductDocumento,PrecioProductDocumento,CodProductoDocumento)){

       var IdProducto= $("#InternoProductoVenta").val();
       var cantidad,preciounitario,subtotalVentaProducto,VAlorVEntaTotal;

        $.ajax({
         type: 'post',
         url:'?c=documento_venta&a=TablaValorVentaIn',
         //data:'idtabla'+idtabla
         data:'IdProducto='+IdProducto
         //data:'id='+num
     
        }).done(function(resp){

           // alert(resp);
              var valores = eval(resp);
              cantidad = $("#CantidadProductoVEntaIn").val();
              preciounitario=$("#PrecioProductoVEntaIn").val(); 
              subtotalVentaProducto=cantidad*preciounitario;


               decuentopedido=$("#DescuentoProductoPedido").val();  
              

              if(DescuentoItemVenta==0){
                DescuentoObtenido=0;
              }
              else{
                DescuentoObtenido=((cantidad*preciounitario)*DescuentoItemVenta)/100;
              }


              

                $("#TablaPrincipalDocumentoVenta").append('<tbody></tbody>');
                $("#TablaPrincipalDocumentoVenta > tbody:last-child ").append('<tr><td>'+IdVentaDocVen+'</td><td><input type="hidden" name="tblidTablaPrincipal[]" value="'+valores[0][0]+'">'+valores[0][1]+'</td><td><input type="hidden" name="tbldescripcionTablaPrincipal[]" value="'+valores[0][2]+'">'+valores[0][2]+'</td><td>'+valores[0][3]+'</td><td><input type="hidden" name="tblcantidadTablaPrincipal[]" value="'+cantidad+'">'+cantidad+'</td><td><input type="hidden" name="tblpreciounitarioTablaPrincipal[]" value="'+preciounitario+'">'+preciounitario+'</td><td><input type="hidden" name="tbldescuentoObtenido[]" value="'+DescuentoObtenido+'">'+DescuentoObtenido+'</td><td><input type="hidden" name="tblsubtotalTablaPrincipal[]" value="'+subtotalVentaProducto+'">'+subtotalVentaProducto+'</td><td><input type="hidden" name="tblBonificacionTablaPrincipal[]" value="1"> <i class="fa fa-fw fa-check"></i></td><td><button class="btn btn-danger btn-sm  "  rel="tooltip" title="Quitar"  onclick=QuitarElementoSeleccionado("'+valores[0][1]+'")><i class="fa fa-fw fa-trash-o"></i></button></td></td></tr>');
       
        recalcularDocumentoVenta();

        IdVentaDocVen++;
        
        });  
        }  

         

    }



    function recalcularDocumentoVenta(){
 


                var VAlorVEntaTotal,igv,ImporteTotalVEnta,subtotal,Descuento,DescuentoFinal;




                subtotal=ObtenerValorVentaIn();   
                //redondeo
                subtotal=subtotal.toFixed(4);
                //


                $("#SubtotalDocumentoVentaIn").val(subtotal);

                Descuento=$("#DescuentoFinancieroVAlorVenta").val();

                if(Descuento>0){
                    DescuentoFinal=(subtotal*Descuento)/100;
                }
                else{
                    DescuentoFinal=0;
                }

                //redondeo
                DescuentoFinal=DescuentoFinal.toFixed(4);
                //

                $("#DescuentoFinancieroVAlorVentaVista").val(Descuento);


                VAlorVEntaTotal=subtotal-DescuentoFinal;


                //redondeo
                VAlorVEntaTotal=VAlorVEntaTotal.toFixed(4);
                //

                //VAlorVEntaTotal=ObtenerValorVentaPedidoIN();   
                $("#VAlorVEntaTotal").val(VAlorVEntaTotal);

                var igv=IGVValorVenta(VAlorVEntaTotal); 

                //redondeo
                igv=igv.toFixed(4);
                //


                $("#IGVValorVEnta").val(igv);

                var ImporteTotalVEnta=parseFloat(igv)+parseFloat(VAlorVEntaTotal); 

                 //redondeo
                ImporteTotalVEnta=ImporteTotalVEnta.toFixed(4);
                //

                $("#ImporteTotalVEnta").val(ImporteTotalVEnta);




    }



     function QuitarElementoSeleccionado(NumerodeDatos)
    {


            var elementosTabla=1;
           $('#TablaPrincipalDocumentoVenta tbody tr').each(function() {
               var codigo=$(this).closest("tr").find("td:nth-child(2)").text();
               if(codigo == NumerodeDatos)
                {
                 $(this).closest("tr").remove();
                }

            });

            $('#TablaPrincipalDocumentoVenta tbody tr').each(function() {
               var codigo=$(this).closest("tr").find("td:nth-child(1)").text(elementosTabla);
               if(codigo == NumerodeDatos)
                {
                 $(this).closest("tr").remove();
                }
                elementosTabla++;

            });



          IdVentaDocVen--;
      
          recalcularDocumentoVenta();
    
    
    }



      function QuitarCampos()
    {


        if(IdVentaDocVen>1){

             //  $('#TablaPrincipalDocumentoVenta tbody').remove();
                //$("#TablaPrincipalDocumentoVenta").append('<tbody></tbody>');
          var rowCount = $('#TablaPrincipalDocumentoVenta >tbody >tr').length;
          if(rowCount!=0){
                  $("#TablaPrincipalDocumentoVenta > tbody:last-child ").remove();
                   //   contador--;
          }

           

        IdVentaDocVen--;
        }

        recalcularDocumentoVenta();
  

    }


    function ObtenerValorVentaIn()
    {

        var numerototales=0;
       $('#TablaPrincipalDocumentoVenta tbody tr').each(function() {

        //var customerId=$(this).closest("tr").find("td:nth-child(1)").text(conteo);
        var subtotalproducto=$(this).closest("tr").find("td:nth-child(8)").text();
        //alert(subtotalproducto);
        var num = parseFloat(subtotalproducto);
        //alert(num);
        if(!isNaN(num))
        {
        numerototales+=num;
        }
        //conteo++;
        });


        return numerototales;
    }

    function IGVValorVenta(VAlorVEntaTotal)
    {

      
      //var TotalDocumentoVenta=parseFloat(VAlorVEntaTotal)+parseFloat(((VAlorVEntaTotal*18)/100));
      var igv=(VAlorVEntaTotal*18)/100;

        return igv;
    }


    function GuardarDocumentoVenta()
    { 

          var SerieDocumento = $('#SeriDocumentoVenta').val();
          var NumDocumento = $('#NumeroDocumentoVenta').val();


          var GRemSerDocumento = $('#GRemSerieDocumentoVenta').val();
          var GRemNumDocumento = $('#GRemNumDocumentoVenta').val();

          var CodProductoDocumento = $('#CodProductoVEntaIn').val();
          var NombreProductDocumento = $('#NombreProductoVEntaIn').val();

          var CantidadProductDocumento = $('#CantidadProductoVEntaIn').val();
          var PrecioProductDocumento = $('#PrecioProductoVEntaIn').val();

          var ClienteCodigoDocumento = $('#DAtoClientesid').val();
          var ClienteNameDocumento = $('#DAtoClientesname').val();

          var ImporteTotalDocumento = $('#ImporteTotalVEnta').val();
          var FechaDocumento = $('#datepicker').val();

          var TAblaCantidad = $('#TablaPrincipalDocumentoVenta >tbody >tr').length;
          var ElemntoSeleccionadoDocumento=true;

          var dataString = $("#frmsumbit1, #frmsumbit2, #frmsumbit3, #frmsumbit4").serialize();

          var tester=0;

           if(!ClienteTablaDocumentoVEntaValidaror(ClienteCodigoDocumento,TAblaCantidad,ImporteTotalDocumento,FechaDocumento,SerieDocumento,NumDocumento)){
               
                  $.ajax( {
                    type: 'POST',
                    url: '?c=documento_venta&a=SeriDocumentoDocumento',
                   // data: dataString,
                        }).done(function(responderValores){
                           //alert(resp);
                           // location.href="index.php?c=documento_venta";
                          var dAtosDocumentoValor = eval(responderValores);
                          var i=0;
                          var numero=dAtosDocumentoValor.length;
                          //alert(numero);
                          //while (ElemntoSeleccionadoDocumento==false){
                          // while (ElemntoSeleccionadoDocumento==false||i<numero) {
                             // alert(dAtosDocumentoValor[i][0]+'   '+dAtosDocumentoValor[i][1]+'   '+i);

                            //alert(ElemntoSeleccionadoDocumento);

                          while ((tester==0)&&(i<numero)) {
                             // alert(i);

                                  if((dAtosDocumentoValor[i][0]==SerieDocumento)&&(dAtosDocumentoValor[i][1]==NumDocumento)){
                                   // alert("Nunca entra VErdadero");
                                         tester=1;
                                         //return false;
                                   }
                               i++;

                            }

                          
                            if(tester==0){

                                  $('#ExisteNoexiste').removeClass("has-error");
                                  $('#ExisteNoexiste').hide();
                                  $('#SerieDocumentoDocVent').removeClass("has-error");
                                     
                                    if($('#GenerarGuiasDocumento').is(':checked'))
                                    { 
                                          $('#confirm-DocumentoVenta').modal("toggle"); 
                                          $('#OKGuardarDocumento').on('click', function (e) {
                                                     $.ajax( {
                                                      type: 'POST',
                                                      url: '?c=documento_venta&a=Guardar',
                                                      data: dataString,
                                                       }).done(function(resp){                                          
                                                         alert(resp);

                                                         //$('#confirm-DocumentoVentaImpresion').modal("toggle"); 
                                                           //  $('#OKGuardarDocumentoImpresion').on('click', function (e) {
                                                             //   window.print();

                                                             //}); 
                                                            //$('#CancelGuardarDocumentoImpresion').on('click', function (e) {
                                                             //   location.href="index.php?c=documento_venta";
                                                            // }); 
                                                               
                                                      
                                                                                         
                                                       // location.href="index.php?c=documento_venta";                                          
                                                  });   
                                         
                                          });
                                      
                                          

                                  
                           

                                    } 
                                    else
                                    { 
                                             $.ajax( {
                                                type: 'POST',
                                                url: '?c=documento_venta&a=Guardar',
                                                data: dataString,
                                              }).done(function(resp){                                          
                                                   alert(resp);
                                                 //  $('#ExisteNoexiste').removeClass("has-error");
                                                 //  $('#ExisteNoexiste').hide();
                                                 //  $('#SerieDocumentoDocVent').removeClass("has-error");                                         
                                                                             
                                            });   
                                                            
                                     }
                                                                       
                                   }
                                   else{
                                    var SeleccionadoText=$('#Tipo_Doc option:selected').text();                                    
                                    $('#FacturaBoletaExiste').text('La  '+SeleccionadoText+'  '+SerieDocumento+' - '+NumDocumento+' ya existe e intente con otro')

                                        $('#ExisteNoexiste').show();
                                        $('#ExisteNoexiste').addClass("has-error");  
                                        $('#SerieDocumentoDocVent').addClass("has-error"); 
                                   }
                    });
        }

    }






    function PassworddDocumentoVenta()
    {
         var PasswordDVT=$('#PasswordDVT').val();
         var confirm="test";
         if(PasswordDVT==confirm){
          $('#PrecioProductoVEntaIn').prop('readonly', false);
          $('#PUnitarioValidardor').removeClass("has-error");
         }
         else{
            $('#PrecioProductoVEntaIn').prop('readonly', true);
            $('#PUnitarioValidardor').addClass("has-error");
            
         }
      
        
    }






  function ProductosTablaDocumentoVEntaValidaro(erro1,erro2,erro3)
  {           var AlertaProductos;
              var CantidadProductDocumento = truefalse(erro1);
              var PrecioProductDocumento = truefalse(erro2);
              var CodProductoDocumento = VAlidarTablaDocumentoProducto(erro3);
              var CodProductoDocumentoVenta = truefalse(erro3);

              
    if((CantidadProductDocumento==true)||(PrecioProductDocumento==true)||(CodProductoDocumento==true)||(CodProductoDocumentoVenta==true))
      {
                     AlertaProductos=true;
                     $('#validacionalerta').show();
                     $('#validacionalerta').addClass("has-error");                     
            
           
                    if(CantidadProductDocumento==true){ $('#TxtCantidad').show();
                                     $('#CantidadDocVent').addClass("has-error");
                    }
                    else{ $('#TxtCantidad').hide();
                          $('#CantidadDocVent').removeClass("has-error");
                    }
      

                     if(PrecioProductDocumento==true){ $('#TxtPUnitario').show();
                                     $('#PUnitarioValidardor').addClass("has-error");
                    }
                    else{ $('#TxtPUnitario').hide();
                          $('#PUnitarioValidardor').removeClass("has-error");
                    }

                    if(CodProductoDocumento==true){ $('#TxtTablaProducto').show();
                           //          $('#PUnitarioValidardor').addClass("has-error");
                    }
                    else{ $('#TxtTablaProducto').hide();
                         // $('#PUnitarioValidardor').removeClass("has-error");
                    }

                    if(CodProductoDocumentoVenta==true){ $('#TxtProductoCodigo').show();
                         $('#ProductoDocVent').addClass("has-error");
                    }
                    else{ $('#TxtProductoCodigo').hide();
                          $('#ProductoDocVent').removeClass("has-error");
                    }
            

        }
            else
        {
               // alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
                $('#validacionalerta').removeClass("has-error");
            //    $('#errorvalidadorinputs').removeClass("has-error");
                $('#validacionalerta').hide();
                AlertaProductos=false;
        }
            
            return AlertaProductos;
  }

  function ClienteTablaDocumentoVEntaValidaror(erro1,erro2,erro3,erro4,error5,error6){

              var ClienteAlerta;
              var ClienteCodigoDocumento = truefalse(erro1);
              var TAblaCantidad = truefalseTablaDocumento(erro2);
              var ImporteTotalDocumento = truefalse(erro3);
              var FechaDocumento = compararFechaDocuemnto(erro4);
              var GRemisonNum,GRemisionSerie,Serie1,Serie2;
              var SerieDocumento = truefalse(error5);
              var NumDocumento = truefalse(error6);

         
                if($('#GenerarGuiasDocumento').is(':checked'))
                { 
                      
                      
                   Serie1 = $('#GRemSerieDocumentoVenta').val();
                   Serie2 = $('#GRemNumDocumentoVenta').val();

                    GRemisionSerie=truefalse(Serie1);
                    GRemisonNum=truefalse(Serie2); 

                } 
                else
                {
                         
                         GRemisionSerie=false;
                         GRemisonNum=false;   
                              
                                
               }
          



            if((ClienteCodigoDocumento==true)||(TAblaCantidad==true)||(ImporteTotalDocumento==true)||(FechaDocumento==true)||(GRemisionSerie==true)||(GRemisonNum==true)||(SerieDocumento==true)||(NumDocumento==true))
            {
                     ClienteAlerta=true;
                     $('#validacionalertaCliente').show();
                     $('#validacionalertaCliente').addClass("has-error");                     
            
           
                    if(ClienteCodigoDocumento==true){ 
                      $('#TxtClienteDocumentoValidador').show();
                      $('#ClienteDocVent').addClass("has-error");
                    }
                    else{ $('#TxtClienteDocumentoValidador').hide();
                          $('#ClienteDocVent').removeClass("has-error");
                    }
      

                    if(TAblaCantidad==true){ $('#TxtProductoValidaro').show();
                                   ///  $('#PUnitarioValidardor').addClass("has-error");
                    }
                    else{ $('#TxtProductoValidaro').hide();
                        //  $('#PUnitarioValidardor').removeClass("has-error");
                    }

                    if(ImporteTotalDocumento==true){ $('#TxtimporteTotalValidador').show();
                            $('#ImporteDocVent').addClass("has-error");
                    }
                    else{ $('#TxtimporteTotalValidador').hide();
                            $('#ImporteDocVent').removeClass("has-error");
                    }

                    if(FechaDocumento==true){ $('#TxtFechaHoy').show();
                         $('#FechaDocVen').addClass("has-error");
                    }
                    else{ $('#TxtFechaHoy').hide();
                          $('#FechaDocVen').removeClass("has-error");
                    }

                    if(GRemisionSerie==true){ $('#TxtGRemision').show();
                         $('#GRemDocVent').addClass("has-error");
                    }
                    else{ $('#TxtGRemision').hide();
                          $('#GRemDocVent').removeClass("has-error");
                    }

                    if(GRemisonNum==true){ $('#TxtGRemision').show();
                         $('#GRemDocVent').addClass("has-error");
                    }
                    else{ $('#TxtGRemision').hide();
                          $('#GRemDocVent').removeClass("has-error");
                    }
                    if(SerieDocumento==true){ $('#TxtSerieNumero').show();
                         $('#SerieDocumentoDocVent').addClass("has-error");
                    }
                    else{ $('#TxtSerieNumero').hide();
                          $('#SerieDocumentoDocVent').removeClass("has-error");
                    }
                    if(NumDocumento==true){ $('#TxtSerieNumero').show();
                         $('#SerieDocumentoDocVent').addClass("has-error");
                    }
                    else{ $('#TxtSerieNumero').hide();
                          $('#SerieDocumentoDocVent').removeClass("has-error");
                    }
              
              

            }else
            {
               // alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
                $('#validacionalertaCliente').removeClass("has-error");
            //    $('#errorvalidadorinputs').removeClass("has-error");
                $('#validacionalertaCliente').hide();
                ClienteAlerta=false;
            }
            
            return ClienteAlerta;


    }


     function truefalseTablaDocumento(SErerERRotipoValidador){
        var truefalsevar;
        if(SErerERRotipoValidador<1){
            truefalsevar=true;
         }
         else{
            truefalsevar=false;
         }
       //  alert('cantidad'+SErerERRotipoValidador+'campos '+truefalsevar);
         return truefalsevar;

    }

    function VAlidarTablaDocumentoProducto(Objetoseleccionado){

        var seleccionTabla;
   
        $('#TablaPrincipalDocumentoVenta tbody tr').each(function() {
           var codigo=$(this).closest("tr").find("td:nth-child(1)").text();
           if(codigo == Objetoseleccionado)
            {
                seleccionTabla=true;
                return false; 
            }
               else{
                seleccionTabla=false;
            }

        });



             return seleccionTabla;



    }


    function VAlidarTablaDocumentoProductoPedido(Objetoseleccionado){

        var seleccionTabla;
   
        $('#PedidoMercaderiaPrincipalTabla tbody tr').each(function() {
           var codigo=$(this).closest("tr").find("td:nth-child(2)").text();
           if(codigo == Objetoseleccionado)
            {
                seleccionTabla=true;
                return false; 
            }
               else{
                seleccionTabla=false;
            }

        });



             return seleccionTabla;



    }




    function compararFechaDocuemnto(startDt){
      var hoy = new Date();
      var dd = hoy.getDate();
      var mm = hoy.getMonth()+1; //hoy es 0!
      var yyyy = hoy.getFullYear();
      var fecha=mm+'/'+dd+'/'+yyyy;

     // alert(startDt+'   abc  '+fecha)
      var truefalsevar;
        if( (new Date(startDt).getTime() >= new Date(fecha).getTime()))
          {
              truefalsevar=false;
          }
          else{

              truefalsevar=true;
          }
          return truefalsevar;
    }



  function ModalPedidoMercaderia()
  {
      var usuarioBloqueo;
       $.ajax({
         type: 'post',
         url:'?c=pedidos_mercaderia&a=TablaModalPersonasPedidoMercaderia',     
        }).done(function(resp){
              var valores = eval(resp);
               $('#PedidoMercaderiModalPersona tbody').remove();
                    $("#PedidoMercaderiModalPersona").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                          
                          if(valores[i][5]=='Bloqueado'){
                               usuarioBloqueo= ' onclick="return false;" disabled ';
                                }
                            else{
                                usuarioBloqueo=' data-dismiss="modal"  onclick="closeModalPedidoMercaderiaUsuario('+valores[i][0]+')" ';
                            }
                    $("#PedidoMercaderiModalPersona tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td> <a href="" class="btn btn-social-icon btn-info btn-sm" '+usuarioBloqueo+'  rel="tooltip" title="Seleccionar" ><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }
            $("#PedidoMercaderiModalPersona").dataTable().fnDestroy();
             var datatabledocumentoVenta =  $('#PedidoMercaderiModalPersona').DataTable();  
          });


  }

    function ModalDocumentodeVentaProductosPedidoMercaderia(){
          $.ajax({
         type: 'post',
         url:'?c=pedidos_mercaderia&a=TablaModalProductosPedidoMercaderia',     
        }).done(function(resp){

              var valores = eval(resp);

              var ProductosBloqueados;

               $('#PedidoMercaderiaProducto tbody').remove();
                    $("#PedidoMercaderiaProducto").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                          


                         if(valores[i][5]<=0){
                                  ProductosBloqueados= ' onclick="return false;" disabled ';
                                }
                            else{
                                ProductosBloqueados=' data-dismiss="modal"  onclick="closeModalProductosPedidoMercaderia('+valores[i][0]+')" ';
                            }



                    $("#PedidoMercaderiaProducto tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td>'+valores[i][6]+'</td><td> <a href="" class="btn btn-social-icon btn-info btn-sm"  rel="tooltip" title="Seleccionar" '+ProductosBloqueados+'><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }

            $("#PedidoMercaderiaProducto").dataTable().fnDestroy();
             var DocumentoVEntaProductosModal =  $('#PedidoMercaderiaProducto').DataTable();

  
          });

    
  }

    function closeModalPedidoMercaderiaUsuario(idtabla){

         $.ajax({
         type: 'post',
         url:'?c=pedidos_mercaderia&a=DatosClientesPedidoMercaderia',
         data:'idtabla='+idtabla
         }).done(function(resp){

              var valores = eval(resp);


            
             $("#IdPedidoCliente").val(valores[0][0]);
             $("#NombrePedidoCliente").val(valores[0][1]);
             //$("#TipoDocPedido").val(valores[0][2]);            
             
             if(valores[0][2]==""){
             $("#TipoDocPedido").val("DNI");  
             $("#NumDocPedido").val(valores[0][3]);
             }
             else{
            $("#TipoDocPedido").val("RUC");  
             $("#NumDocPedido").val(valores[0][2]);
             }
             $("#DireccionPedido").val(valores[0][4]);
             $("#UBgdPedidoCliente").val(valores[0][5]);
             $("#LineaCreditoPedidoCliente").val(valores[0][6]);

             
             

      
      });
  }


    function closeModalProductosPedidoMercaderia(idtabla)
    {
         $.ajax({
         type: 'post',
         url:'?c=pedidos_mercaderia&a=DatosProductosPedidoMercaderia',
         //data:'idtabla'+idtabla
         data:'idtabla='+idtabla
        }).done(function(resp){
              var valores = eval(resp);            
             $("#InternoProductoPedido").val(valores[0][0]);
             $("#CodigoProductoPedido").val(valores[0][1]);
             $("#NombreProductoPedido").val(valores[0][2]);
             $("#PrecioUProductoPedido").val(valores[0][3]);
             $("#VentaUProductoPedido").val(valores[0][3]);

             $("#CantidadProductoPedido").val(0);
             $("#DescuentoProductoPedido").val(0);
             $("#DescuentoFinacieroProductoPedido").val(0);

             



      
      });


    }

    var PedidoMercaderiaContador=1;

    function AgregarCamposPedidoMercaderia()
    { 

        var CantidadProductDocumento = $('#CantidadProductoPedido').val();
        var PrecioProductDocumento = $('#PrecioUProductoPedido').val();
        var CodProductoDocumento = $('#CodigoProductoPedido').val();


       if(!PedidoProductoTabla(CantidadProductDocumento,PrecioProductDocumento,CodProductoDocumento)){

       var IdProducto= $("#InternoProductoPedido").val();
     //  var cantidad,preciounitario,subtotalVentaProducto,VAlorVEntaTotal;

        $.ajax({
         type: 'post',
         url:'?c=pedidos_mercaderia&a=TablaPedidoMercaderia',
         //data:'idtabla'+idtabla
         data:'IdProducto='+IdProducto
         //data:'id='+num
     
        }).done(function(resp){

           // alert(resp);
              var valores = eval(resp);
              var DescuentoObtenido;
              cantidad = $("#CantidadProductoPedido").val();
              preciounitario=$("#PrecioUProductoPedido").val();
              decuentopedido=$("#DescuentoProductoPedido").val();  
              

              if(decuentopedido==0){
                DescuentoObtenido=0;
              }
              else{
                DescuentoObtenido=((cantidad*preciounitario)*decuentopedido)/100;
              }

              subtotalVentaProducto=(cantidad*preciounitario)-DescuentoObtenido;

              ///Redondedo
              var VistasubtotalVentaProducto=subtotalVentaProducto.toFixed(2);

              subtotalVentaProducto=subtotalVentaProducto.toFixed(4);
              ////


                $("#PedidoMercaderiaPrincipalTabla").append('<tbody></tbody>');
                $("#PedidoMercaderiaPrincipalTabla > tbody:last-child ").append('<tr><td>'+PedidoMercaderiaContador+'</td><td><input type="hidden" name="tblidTablaPrincipal[]" value="'+valores[0][0]+'">'+valores[0][1]+'</td><td><input type="hidden" name="tbldescripcionTablaPrincipal[]" value="'+valores[0][2]+'">'+valores[0][2]+'</td><td>'+valores[0][3]+'</td><td><input type="hidden" name="tblcantidadTablaPrincipal[]" value="'+cantidad+'">'+cantidad+'</td><td><input type="hidden" name="tblpreciounitarioTablaPrincipal[]" value="'+preciounitario+'">'+preciounitario+'</td><td><input type="hidden" name="tbldescuentoTablaPrincipal[]" value="'+decuentopedido+'">'+decuentopedido+'</td><td><input type="hidden" name="tblsubtotalTablaPrincipal[]" value="'+subtotalVentaProducto+'">'+VistasubtotalVentaProducto+'</td><td><input type="hidden" name="tblBonificacionTablaPrincipal[]" value="0"></td><td><button class="btn btn-danger btn-sm  "  rel="tooltip" title="Quitar"  onclick=QuitarElementoSeleccionadoPedido("'+valores[0][1]+'")><i class="fa fa-fw fa-trash-o"></i></button></td></td></tr>');
       
      
        PedidoMercaderiaContador++;


        recalcularDocumentoVentaPedido();


        });  


    }


  } 



    function AgregarCamposPedidoMercaderiaBonificacion()
    { 

        var CantidadProductDocumento = $('#CantidadProductoPedido').val();
        var PrecioProductDocumento = $('#PrecioUProductoPedido').val();
        var CodProductoDocumento = $('#CodigoProductoPedido').val();


       if(!PedidoProductoTabla(CantidadProductDocumento,PrecioProductDocumento,CodProductoDocumento)){

       var IdProducto= $("#InternoProductoPedido").val();
     //  var cantidad,preciounitario,subtotalVentaProducto,VAlorVEntaTotal;

        $.ajax({
         type: 'post',
         url:'?c=pedidos_mercaderia&a=TablaPedidoMercaderia',
         //data:'idtabla'+idtabla
         data:'IdProducto='+IdProducto
         //data:'id='+num
     
        }).done(function(resp){

           // alert(resp);
              var valores = eval(resp);
              var DescuentoObtenido;
              cantidad = $("#CantidadProductoPedido").val();
              preciounitario=0;
              decuentopedido=0;  
              

              if(decuentopedido==0){
                DescuentoObtenido=0;
              }
              else{
                DescuentoObtenido=((cantidad*preciounitario)*decuentopedido)/100;
              }

              subtotalVentaProducto=0;
              


                $("#PedidoMercaderiaPrincipalTabla").append('<tbody></tbody>');
                $("#PedidoMercaderiaPrincipalTabla > tbody:last-child ").append('<tr><td>'+PedidoMercaderiaContador+'</td><td><input type="hidden" name="tblidTablaPrincipal[]" value="'+valores[0][0]+'">'+valores[0][1]+'</td><td><input type="hidden" name="tbldescripcionTablaPrincipal[]" value="'+valores[0][2]+'">'+valores[0][2]+'</td><td>'+valores[0][3]+'</td><td><input type="hidden" name="tblcantidadTablaPrincipal[]" value="'+cantidad+'">'+cantidad+'</td><td><input type="hidden" name="tblpreciounitarioTablaPrincipal[]" value="'+preciounitario+'">'+preciounitario+'</td><td><input type="hidden" name="tbldescuentoTablaPrincipal[]" value="'+decuentopedido+'">'+decuentopedido+'</td><td><input type="hidden" name="tblsubtotalTablaPrincipal[]" value="'+subtotalVentaProducto+'">'+subtotalVentaProducto+'</td><td><input type="hidden" name="tblBonificacionTablaPrincipal[]" value="1"> <i class="fa fa-fw fa-check"></i></td><td><button class="btn btn-danger btn-sm  "  rel="tooltip" title="Quitar"  onclick=QuitarElementoSeleccionadoPedido("'+valores[0][1]+'")><i class="fa fa-fw fa-trash-o"></i></button></td></td></tr>');
       
      
        PedidoMercaderiaContador++;


        recalcularDocumentoVentaPedido();


        });  


    }


  } 









        function QuitarElementoSeleccionadoPedido(NumerodeDatos)
        {
            var elementosTabla=1;
           $('#PedidoMercaderiaPrincipalTabla tbody tr').each(function() {
               var codigo=$(this).closest("tr").find("td:nth-child(2)").text();
               if(codigo == NumerodeDatos)
                {
                 $(this).closest("tr").remove();
                }

            });

            $('#PedidoMercaderiaPrincipalTabla tbody tr').each(function() {
               var codigo=$(this).closest("tr").find("td:nth-child(1)").text(elementosTabla);
               if(codigo == NumerodeDatos)
                {
                 $(this).closest("tr").remove();
                }
                elementosTabla++;

            });

           PedidoMercaderiaContador--;

              recalcularDocumentoVentaPedido();

        
        }



      function QuitarCamposPedido()
      {

        if(PedidoMercaderiaContador>1){

             //  $('#TablaPrincipalDocumentoVenta tbody').remove();
                //$("#TablaPrincipalDocumentoVenta").append('<tbody></tbody>');
          var rowCount = $('#PedidoMercaderiaPrincipalTabla >tbody >tr').length;
          if(rowCount!=0){
                  $("#PedidoMercaderiaPrincipalTabla > tbody:last-child ").remove();
                   //   contador--;
          }

           

        PedidoMercaderiaContador--;
        }

        recalcularDocumentoVentaPedido();
          

      }
           


 function recalcularDocumentoVentaPedido(){
      var VAlorVEntaTotal,igv,ImporteTotalVEnta,subtotal,Descuento,DescuentoFinal;




                subtotal=ObtenerValorVentaPedidoIN();   
                //redondeo
                subtotal=subtotal.toFixed(4);
                //


                $("#SubtotalTotalPedido").val(subtotal);
                Descuento=$("#DescuentoFinacieroProductoPedido").val();
                if(Descuento>0){
                    DescuentoFinal=(subtotal*Descuento)/100;
                }
                else{
                    DescuentoFinal=0;
                }

                //redondeo
                DescuentoFinal=DescuentoFinal.toFixed(4);
                //

                $("#DescuentoTotalPedido").val(Descuento);

                VAlorVEntaTotal=subtotal-DescuentoFinal;


                //redondeo
                VAlorVEntaTotal=VAlorVEntaTotal.toFixed(4);
                //

                //VAlorVEntaTotal=ObtenerValorVentaPedidoIN();   
                $("#VAlorVEntaTotalPedido").val(VAlorVEntaTotal);
                var igv=IGVValorVentaPedidoIN(VAlorVEntaTotal); 

                //redondeo
                igv=igv.toFixed(4);
                //


                $("#IGVValorVEntaPedido").val(igv);

                var ImporteTotalVEnta=parseFloat(igv)+parseFloat(VAlorVEntaTotal); 

                 //redondeo
                ImporteTotalVEnta=ImporteTotalVEnta.toFixed(4);
                //

                $("#ImporteTotalVEntaPedido").val(ImporteTotalVEnta);
    }

 function ObtenerValorVentaPedidoIN()
    {

        var numerototales=0;
       $('#PedidoMercaderiaPrincipalTabla tbody tr').each(function() {

        //var customerId=$(this).closest("tr").find("td:nth-child(1)").text(conteo);
        var subtotalproducto=$(this).closest("tr").find("td:nth-child(8)").text();
        //alert(subtotalproducto);
        var num = parseFloat(subtotalproducto);
        //alert(num);
        if(!isNaN(num))
        {
        numerototales+=num;
        }
        //conteo++;
        });


        return numerototales;
    }

    function IGVValorVentaPedidoIN(VAlorVEntaTotal)
    {

      
      //var TotalDocumentoVenta=parseFloat(VAlorVEntaTotal)+parseFloat(((VAlorVEntaTotal*18)/100));
      var igv=(VAlorVEntaTotal*18)/100;

        return igv;
    }


      function PedidoProductoTabla(erro1,erro2,erro3)
      {           var AlertaProductos;
                  var CantidadProductDocumento = truefalse(erro1);
                  var PrecioProductDocumento = truefalse(erro2);
                  var CodProductoDocumento = VAlidarTablaDocumentoProductoPedido(erro3);
                  var CodProductoDocumentoVenta = truefalse(erro3);


                  $('#ProductoValidadorPedidoss').removeClass("has-error");
                  $('#ProductoValidadorPedidos').removeClass("has-error");
                  
        if((CantidadProductDocumento==true)||(PrecioProductDocumento==true)||(CodProductoDocumento==true)||(CodProductoDocumentoVenta==true))
          {
                         AlertaProductos=true;
                         $('#validacionalerta').show();
                         $('#validacionalerta').addClass("has-error");                     
                
               
                        if(CantidadProductDocumento==true){ $('#TxtCantidad').show();
                                         $('#CantidadPedidoVAlidador').addClass("has-error");
                        }
                        else{ $('#TxtCantidad').hide();
                              $('#CantidadPedidoVAlidador').removeClass("has-error");
                        }
            


                         if(PrecioProductDocumento==true){ $('#TxtPUnitario').show();
                                         $('#PrecioUPedidoValidador').addClass("has-error");
                        }
                        else{ $('#TxtPUnitario').hide();
                              $('#PrecioUPedidoValidador').removeClass("has-error");
                        }

                     

                        if((CodProductoDocumentoVenta==true)||(CodProductoDocumento==true))
                        {
                               $('#ProductoValidadorPedidoss').addClass("has-error");
                               $('#ProductoValidadorPedidos').addClass("has-error");

                                    if(CodProductoDocumentoVenta==true)
                                    {

                                        $('#TxtProductoCodigo').show();
                              
                                    }

                              
                                  else{ $('#TxtProductoCodigo').hide();
                            
                                  }


                                if(CodProductoDocumento==true){ $('#TxtTablaProducto').show();

                      
                                }
                                else{ 
                                  $('#TxtTablaProducto').hide();
                               
                                }

                        }
                        else{
                              $('#ProductoValidadorPedidoss').removeClass("has-error");
                              $('#ProductoValidadorPedidos').removeClass("has-error");

                        }

                

            }
                else
            {
                   // alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
                    $('#validacionalerta').removeClass("has-error");
                //    $('#errorvalidadorinputs').removeClass("has-error");
                    $('#validacionalerta').hide();
                    AlertaProductos=false;
            }
                
                return AlertaProductos;
      }


  
   function GuadarPedidoProductos()
  { 

          var IDCliente = $('#IdPedidoCliente').val();
          var Condicion = $('#CondicionProducto').val();
          var CodigoProductoPedido = $('#CodigoProductoPedido').val();
          var ImporteTotalVEntaPedido = $('#ImporteTotalVEntaPedido').val();
          var cantidad = $('#PedidoMercaderiaPrincipalTabla >tbody >tr').length;
         // alert(cantidad);
     
          
          var dataString = $("#frmsumbit1, #frmsumbit2, #frmsumbit3, #frmsumbit4, #frmsumbit5, #frmsumbit6").serialize();

         if(!PedidoProductoTablaValidador(IDCliente,Condicion,CodigoProductoPedido,ImporteTotalVEntaPedido,cantidad)){

              $.ajax( {
                    type: 'POST',
                    url: '?c=pedidos_mercaderia&a=Guardar',
                    data: dataString,
                  }).done(function(resp){
                     //alert(resp);
                      location.href="index.php?c=pedidos_mercaderia";
                    
                });
            //alert("Validado");


      }


    }   


     function PedidoProductoTablaValidador(erro1,erro2,erro3,erro4,erro5)
      {           var AlertaProductos;
                  var IDCliente = truefalse(erro1);
                  var Condicion = truefalse(erro2);
                  var CodProductoDocumento = VAlidarTablaDocumentoProductoPedido(erro3);
                  var CodProductoDocumentoVenta = truefalse(erro3);
                  var ImporteTotalVEntaPedido = truefalse(erro4);
                  var cantidad;
                  if(erro5>0){cantidad=false;}else{cantidad=true;}






                  $('#ProductoValidadorPedidoss').removeClass("has-error");
                  $('#ProductoValidadorPedidos').removeClass("has-error");
                  
        if((ImporteTotalVEntaPedido==true)||(Condicion==true)||(cantidad==true)||(ImporteTotalVEntaPedido==true))
          {
                         AlertaProductos=true;
                         $('#validacionalertaCliente').show();
                         $('#validacionalertaCliente').addClass("has-error");                     
                
               
                        if(IDCliente==true){ $('#TxtClienteDocumentoValidador').show();
                                         $('#ClienteValidador').addClass("has-error");
                                         $('#ClienteValidador2').addClass("has-error");
                                         

                        }
                        else{ $('#TxtClienteDocumentoValidador').hide();
                              $('#ClienteValidador').removeClass("has-error");
                              $('#ClienteValidador2').removeClass("has-error");
                        }
            


                        if(Condicion==true){ $('#TxtFechaHoy').show();
                                         $('#CondiconPedido').addClass("has-error");
                        }
                        else{ $('#TxtFechaHoy').hide();
                              $('#CondiconPedido').removeClass("has-error");
                        }

                        if(ImporteTotalVEntaPedido==true){ $('#TxtimporteTotalValidador').show();
                                         $('#ImportePedido').addClass("has-error");
                        }
                        else{ $('#TxtimporteTotalValidador').hide();
                              $('#ImportePedido').removeClass("has-error");
                        }


                     

                        if(cantidad==true)
                        {
                               $('#ProductoValidadorPedidoss').addClass("has-error");
                               $('#ProductoValidadorPedidos').addClass("has-error");

                    
                                        $('#TxtProductoValidaro').show();
                              
                             
                            
                      

                        }
                        else{
                              $('#ProductoValidadorPedidoss').removeClass("has-error");
                              $('#ProductoValidadorPedidos').removeClass("has-error");

                               $('#TxtProductoValidaro').hide();

                        }

                

            }
                else
            {
                   // alert('msj1'+msj1+'msj2'+msj2+'msj3'+msj3+'msj4'+msj4);
                    $('#validacionalertaCliente').removeClass("has-error");
                //    $('#errorvalidadorinputs').removeClass("has-error");
                    $('#validacionalertaCliente').hide();
                    AlertaProductos=false;
            }
                
                return AlertaProductos;
      }


 function ActualizarTablaProductosAprobRchrPedidos(){
  var Pendientes;
  var Aprobados;
  var  Rechazados;

   var datepicker=$('#datepicker').val();
   var datepicker2=$('#datepicker2').val();

   Pendientes= chekedNocheked($('#Pendientes'));
   Aprobados= chekedNocheked($('#Aprobados'));
   Rechazados=chekedNocheked($('#Rechazados'));

    $.ajax({
         type: 'post',
         url:'?c=aprovarrechazar_pedidos&a=TablaListadoDetalle',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         data:'Pendientes='+Pendientes+'&Aprobados='+Aprobados+'&Rechazados='+Rechazados+'&datepicker='+datepicker+'&datepicker2='+datepicker2
     
        }).done(function(resp){
       // alert(resp);
              var valores = eval(resp);

               $('#TableDocumentosAprevarRechazarPedidos tbody').remove();
                    $("#TableDocumentosAprevarRechazarPedidos").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                    $("#TableDocumentosAprevarRechazarPedidos tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td> '+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td><button class="btn btn-social-icon btn-info btn-sm"  data-toggle="modal" data-target="#ModalFormulario"  rel="tooltip" title="Ver Detalle" onclick="DetalleModalPedidos('+valores[i][0]+')"  ><i class="fa fa-fw fa-eye"></i></button>  <a class="btn btn-social-icon btn-success btn-sm" data-href="?c=aprovarrechazar_pedidos&a=Aprobar&Id='+valores[i][0]+'&Estado=6"  data-target="#confirm-aprov" data-toggle="modal" rel="tooltip" title="Aprobar O.C"><i class="fa fa-fw fa-check-square-o"></i></a>  <a class="btn btn-social-icon btn-danger btn-sm" data-href="?c=aprovarrechazar_pedidos&a=Rechazar&Id='+valores[i][0]+'&Estado=7" data-target="#confirm-delete" data-toggle="modal" rel="tooltip" title="Rechazar O.C"><i class="fa fa-fw fa-close"></i></a></td></tr>');
                    }
    

  
          });





//    alert(datepicker+" * "+datepicker2+" * "+Pendientes+" * "Aprobados+" * "+Rechazados);

//alert(datepicker+" * "+datepicker2+" * "+Pendientes+" * "+Aprobados+" * "+Rechazados);

  }

function DetalleModalPedidos(id){


     var num=id;



      $.ajax({
         type: 'post',
         url:'?c=aprovarrechazar_pedidos&a=TablaListadoDetalleDetalleuSUARI',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         data:'id='+num
     
        }).done(function(resp){

              var dtaosPedido = eval(resp);

          $('#ModalCondicionPedido').val(dtaosPedido[0][0]);
          $('#ModalLineaCreditoPedido').val(dtaosPedido[0][1]);
          $('#ModalTotalPedido').val(dtaosPedido[0][2]);
       
            


  
          });



       $.ajax({
         type: 'post',
         url:'?c=aprovarrechazar_pedidos&a=TablaListadoDetalleDetalle',
         //data:{'Pendientes'=Pendientes,'Aprobados'=Aprobados,'Rechazados'=Rechazados,'datepicker'=datepicker,'datepicker2'=datepicker2}
         data:'id='+num
     
        }).done(function(resp){
       // alert(resp);
              var valores = eval(resp);
              var elemento;

               $('#TableDocumentosAprevarRechazarDetallePedido tbody').remove();
                    $("#TableDocumentosAprevarRechazarDetallePedido").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                      if(valores[i][5]==1){
                        elemento=" <i class='fa fa-fw fa-check'></i>";
                      }
                      else{
                        elemento=" ";
                      }
                    $("#TableDocumentosAprevarRechazarDetallePedido tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+elemento+'</td></tr>');
                    }

  

  
          });


  }



  function ModalFormularioClientes()
  {
      //var usuarioBloqueo;
       $.ajax({
         type: 'post',
         url:'?c=planilla_combranza&a=TablaModalClientesPlanilla',     
        }).done(function(resp){
              var valores = eval(resp);

               $('#PlanillaCombranzaModalClientes tbody').remove();
                    $("#PlanillaCombranzaModalClientes").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                          
                          //if(valores[i][5]=='Bloqueado'){
                            //   usuarioBloqueo= ' onclick="return false;" disabled ';
                              //  }
                            //else{
                             //   usuarioBloqueo=' data-dismiss="modal"  onclick="closeModalPedidoMercaderiaUsuario('+valores[i][0]+'//)" ';
                           // }
                    $("#PlanillaCombranzaModalClientes tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td> <a href="" class="btn btn-social-icon btn-info btn-sm" data-dismiss="modal"  rel="tooltip" title="Seleccionar" ><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }
            $("#PlanillaCombranzaModalClientes").dataTable().fnDestroy();
             var datatabledocumentoVenta =  $('#PlanillaCombranzaModalClientes').DataTable();  
          });


  }



  function TAaleEstadoVentZonas(){


   var CombVendedor=$('select[name=CombVendedor]').val();

    $.ajax({
         type: 'post',
         url:'?c=asignar_zonas&a=DetalleRetiro',
         data:'CombVendedor='+CombVendedor
  
        }).done(function(resp){
       // alert(resp);
              var valores = eval(resp);

               $('#VentVendedorZonas tbody').remove();
                    $("#VentVendedorZonas").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                    $("#VentVendedorZonas tbody").append('<tr><td><input type="hidden" name="CodVenZona[]" value="'+valores[0][2]+'">'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td><a  onclick="RetiroVendedorees('+valores[0][2]+','+valores[0][3]+')" class="btn btn-social-icon btn-danger btn-sm"  rel="tooltip" title="Borrar" ><i class="fa fa-fw fa-trash"></i></a></td></tr>');
                    }
    

  
          });

  }


  function ModalPedidoFActuracion()
  {
      //var usuarioBloqueo;
       $.ajax({
         type: 'post',
         url:'?c=facturacion_pedido&a=FacturarPedido',     
        }).done(function(resp){
              var valores = eval(resp);

               $('#FacturarPedidoTableDetalle tbody').remove();
                    $("#FacturarPedidoTableDetalle").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                          
                    $("#FacturarPedidoTableDetalle tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td>'+valores[i][6]+'</td><td><a href="" class="btn btn-social-icon btn-info btn-sm" data-dismiss="modal"  rel="tooltip" title="Seleccionar" onclick=CloseFacturacionPedido("'+valores[i][0]+'") ><i class="fa fa-fw fa-check-circle"></i></a> </td></tr>');
                    }
            $("#FacturarPedidoTableDetalle").dataTable().fnDestroy();
             var FacturarPedidoTableDetalle =  $('#FacturarPedidoTableDetalle').DataTable();  
          });


  }



  function CloseFacturacionPedido(iDpedido)
  {

       $.ajax({
         type: 'post',
         url:'?c=facturacion_pedido&a=PedidoDocumentoIDget',  
         data:'PedidoId='+iDpedido
        }).done(function(resp){
              var valores = eval(resp);

                  
                $('#Condicion').val(valores[0][0]);
                $('input[name=FechaEmision]').val(valores[0][1]);

                if(valores[0][4]=="")
                {
                    $('#TipoDocumentoClienteIn').val(valores[0][5]);
                }
                else
                {
                   $('#TipoDocumentoClienteIn').val(valores[0][4]);
                }
                $('#DAtoClientesid').val(valores[0][2]);
                $('#DAtoClientesname').val(valores[0][3]);
                
                $('#ClienteDireccionIn').val(valores[0][6]);
                $('#SubtotalDocumentoVentaIn').val(valores[0][7]);
                $('#DescuentoFinancieroVAlorVentaVista').val(valores[0][8]);
                $('#VAlorVEntaTotal').val(valores[0][9]);
                $('#IGVValorVEnta').val(valores[0][10]);
                $('#ImporteTotalVEnta').val(valores[0][11]);
              
          });

        $.ajax({
         type: 'post',
         url:'?c=facturacion_pedido&a=PedidoDocumentoIDgetdETALLE',  
         data:'PedidoId='+iDpedido
        }).done(function(resp){
              var valores = eval(resp);

                  
               $('#TablaPrincipalDocumentoVenta tbody').remove();
                    $("#TablaPrincipalDocumentoVenta").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){

                        if(valores[0][8]==0){
                          BonifiValor="";

                        }
                        else{

                          BonifiValor="<i class='fa fa-fw fa-check'></i>";

                        }
                          
                        $("#TablaPrincipalDocumentoVenta").append('<tbody></tbody>');
                        $("#TablaPrincipalDocumentoVenta > tbody:last-child ").append('<tr><td>'+(i+0)+'</td><td><input type="hidden" name="tblidTablaPrincipal[]" value="'+valores[0][0]+'">'+valores[0][1]+'</td><td><input type="hidden" name="tbldescripcionTablaPrincipal[]" value="'+valores[0][2]+'">'+valores[0][2]+'</td><td>'+valores[0][3]+'</td><td><input type="hidden" name="tblcantidadTablaPrincipal[]" value="'+valores[0][4]+'">'+valores[0][4]+'</td><td><input type="hidden" name="tblpreciounitarioTablaPrincipal[]" value="'+valores[0][5]+'">'+valores[0][5]+'</td><td><input type="hidden" name="tbldescuentoObtenido[]" value="'+valores[0][6]+'">'+valores[0][6]+'</td><td><input type="hidden" name="tblsubtotalTablaPrincipal[]" value="'+valores[0][7]+'">'+valores[0][7]+'</td><td><input type="hidden" name="tblBonificacionTablaPrincipal[]" value="'+valores[0][8]+'"> '+BonifiValor+'</td></td><td><a class="btn btn-danger btn-sm  "  rel="tooltip" title="Quitar"  ><i class="fa fa-fw fa-trash-o"></i></a></td></td></tr>');

              }
              
          });


  }



  function ImprimirDocumentoForm(){

    //$('[DFT="tooltip"]').tooltip();  
  
                var dataString = $("#frmimprimir1, #frmimprimir2").serialize();
                $.ajax( {
                    type: 'POST',
                    url: '?c=imprimir_documento&a=TablaListarDetalleDocumentoCo',
                    data: dataString,
                  }).done(function(resp){

                  var valores = eval(resp);
                  var tipodoc=$("#tipo_documento").val();
              

                    $('#imprimirdocumentotbdprincipal tbody').remove();
                    $("#imprimirdocumentotbdprincipal").append('<tbody></tbody>');
                    for(i=0;i<valores.length;i++){
                    $("#imprimirdocumentotbdprincipal tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td><td>'+valores[i][5]+'</td><td><td>    <a  href="?c=imprimir_documento&a=Imprimir&doc='+tipodoc+'&id='+valores[i][1]+'&ser='+valores[i][2]+'&num='+valores[i][3]+'" class="btn btn-social-icon btn-success btn-sm"  rel="tooltip" title="Imprimir" ><i class="fa fa-fw fa-print"></i></a></td></tr>');
                    }         
                
                });

  }



  function ZonasVentaTab(){

              
    var Locacion=$('#LocationForm1').val();
    var LocacionSelect = $('#LocationForm1 option:selected').text();          
       
                    $("#ZonasVenta tbody").append('<tr><td><input type="hidden" name="ZonaTBd[]" value="'+Locacion+'">'+Locacion+'</td><td>'+LocacionSelect+'</td><td> <a  onclick="QuitarElementoSeleccionadoZonaVentaTBd('+Locacion+')"class="btn btn-social-icon btn-danger btn-sm"  rel="tooltip" title="Borrar" ><i class="fa fa-fw fa-trash"></i></a></td></tr>');
                  

  }


  function QuitarElementoSeleccionadoZonaVentaTBd(NumerodeDatos)
  {
       
           $('#ZonasVenta tbody tr').each(function() {
               var codigo=$(this).closest("tr").find("td:nth-child(1)").text();
               if(codigo == NumerodeDatos)
                {
                 $(this).closest("tr").remove();
                }

            });

    }


    function AsignarZonaGuardar(){

  
                var dataString = $("#frmgenerol").serialize();
                $.ajax( {
                    type: 'POST',
                    url: '?c=asignar_zonas&a=Guardar',
                    data: dataString,
                  }).done(function(resp){
                     

                    RefrescarZonas();

           
                
                });

  }



   function RefrescarZonas(){

     var dataString = $("#frmgenerol").serialize();

             $.ajax( {
                      type: 'POST',
                      url: '?c=asignar_zonas&a=ComboAjx',
                      data: dataString,
                        }).done(function(resps){

                      valorescombo = eval(resps);
                      var ZonaVendedor = $("#ZonaVendedor");
 
                     
                      ZonaVendedor.find('option').remove();
         
                      ZonaVendedor.append('<option>seleccione</option>');
                        for(i=0;i<valorescombo.length;i++){
                           if(valorescombo[i][1]!="Asignado"){
                                  ZonaVendedor.append('<option value="' + valorescombo[i][0] + '">' +valorescombo[i][1] + '</option>');
    
                            }
                          }
                      ZonaVendedor.prop('disabled', false);
                    });



                      $.ajax( {
                      type: 'POST',
                      url: '?c=asignar_zonas&a=VentVendeZonas',
                      data: dataString,
                        }).done(function(respst){
                          var valores=eval(respst);

                          $('#EstadoZonasTBdTbl tbody').remove();
                          $("#EstadoZonasTBdTbl").append('<tbody></tbody>');
                          for(i=0;i<valores.length;i++){
                          $("#EstadoZonasTBdTbl tbody").append('<tr><td>'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td><td>'+valores[i][4]+'</td></tr>');
                          }   


                    });
   }


    function RetiroVendedorees(valcod,valzon){
   

          var CombVendedor=$("#CombVendedor").val();
          var EMPR_Id=$("#EMPR_Id").val();
          
 
              
                $.ajax( {
                    type: 'POST',
                    url: '?c=asignar_zonas&a=RetiroVendedorZonas',
                    data:'Codigo='+valcod+'&Zona='+valzon+'&Vendedor='+CombVendedor+'&Empresa='+EMPR_Id
                  }).done(function(resp){
                         // alert(resp);
                              alert("Codigo"+valcod+"Zona"+valzon+"VEndedor"+CombVendedor);  
                
                });

                  RefrescarZonas();
  }




function TblReporteVen(){

            var dtfec1=$('#datepicker').val();
            var dtfec2=$('#datepicker2').val();
            var catid=$('#CATE_Id').val();
            
                $.ajax( {
                    type: 'POST',
                    url: '?c=incidencia_categoria&a=TblVendedorRpt',
                    data:'FechaInicio='+dtfec1+'&FechaFin='+dtfec2+'&catid='+catid
                  }).done(function(resp){
                    //alert(resp);
                     var valores=eval(resp);

                          $('#RptVendedor tbody').remove();
                          $("#RptVendedor").append('<tbody></tbody>');
                          for(i=0;i<valores.length;i++){
                          $("#RptVendedor tbody").append('<tr><td><input type="hidden" name="tblidTablaPrincipal[]" value="'+valores[i][0]+'">'+valores[i][0]+'</td><td>'+valores[i][1]+'</td><td>'+valores[i][2]+'</td><td>'+valores[i][3]+'</td></tr>');

                         }
                
                });

}



function TblExcelFormRpt($tipodocEPdf){
var Formexe=TblExcelRpt();
  location.href="?c=incidencia_categoria&a=SaldoTablaExcelPdf&Data="+Formexe+"&TipoDoc="+$tipodocEPdf;
}



function Keyaletoria(min, max) {
  var num = Math.round(Math.random() * (max - min) + min);
  return num;
}



function TblExcelRpt(){
  var dtfec1=$('#datepicker').val();
  var dtfec2=$('#datepicker2').val();
  var catid=$('#CATE_Id').val();
  
  var key1 = Keyaletoria(1,10);
  var key2 = Keyaletoria(1,10);
  var fecha = new Date(); 
  var dtfec3=(fecha.getDate()+key1)+"/"+(fecha.getMonth()+key2)+"/"+fecha.getFullYear();



return   dtfec3+"*"+key1+"*"+dtfec1+"*"+dtfec2+"*"+key2+"*"+catid;  

}









$( "#PIAC_Id" ).change(function() {
  $('#cantidad').val(0);
  $('#punitario').val(0);
  $('#dsctoItems').val(0);
  $('#dsctoAdicional').val(0);

});






</script>

<script>

  $('#MesesFijos').prop('disabled', false);
  $('#datepicker4').prop('disabled', true);
  $('#datepicker5').prop('disabled', true);


  $('#MesesChekedFijos').change(function(){
    if($('#MesesChekedFijos').is(':checked')){ 
               //$('#MesesFijos').removeClass("has-error");
                 $('#MesesFijos').prop('disabled', true);
                  $('#datepicker4').prop('disabled', false);
                  $('#datepicker5').prop('disabled', false);
                  

        } else {
                  $('#MesesFijos').prop('disabled', false);
                  $('#datepicker4').prop('disabled', true);
                  $('#datepicker5').prop('disabled', true);
                  
                  
                    
        }
    });

</script>

<script>


  $('#GenerarGuiasDocumento').change(function(){
    if($('#GenerarGuiasDocumento').is(':checked')){ 
               //$('#MesesFijos').removeClass("has-error");
              $('#checkboxguiaremision').val(1);
                    

        } else {
               $('#checkboxguiaremision').val(0);
                  
                  
                    
        }
    });

</script>




</body>
</html>